(window.webPackBridgeJsonp=window.webPackBridgeJsonp||[]).push([[47],{"4240efd871ae15138fcf":function(e,t,r){"use strict";r.d(t,"a",function(){return a});var a=angular.element(document.body).injector().get("bridgeLoggingService")},"7ae84428caea0eb3c5b1":function(e,t,r){"use strict";var a,n;!function(e){e[e.Created=0]="Created",e[e.Opened=1]="Opened",e[e.Failed=2]="Failed",e[e.Memory=3]="Memory"}(a||(a={})),function(e){e[e.Nuked=0]="Nuked",e[e.Cleaned=1]="Cleaned",e[e.Upgraded=2]="Upgraded",e[e.Wiped=3]="Wiped",e[e.Blocked=4]="Blocked",e[e.Downgraded=5]="Downgraded"}(n||(n={})),r.d(t,"a",function(){return a})},db5bd6fd022a1b6b858b:function(e,t,r){"use strict";r.r(t);var a,n=r("64328bb588b46459132d"),i=r("94a755535d135f12850c"),o=r("dc969c026d388e81ff0e"),s=r("e9d155a6651c0bf6c9b0"),c=r("9ba97cc998d0be4df04a"),l=r("cdb9a7d2db44c7a9f4dd"),d={ODB:865,OneDrive:!0},u={ODB:788,OneDrive:!0},f={ODB:1058},p={ODB:1210},h={ODB:1174},b=function(){return function(){this.startTimeMark=(new Date).getTime(),this.deferredListData=!1}}(),w=function(){function e(){}return e.prefetchData=function(t){return e._prefetchData?e._prefetchData[t]:null},e.initPrefetchData=function(t){return e._prefetchData||(e._prefetchData={}),e._prefetchData[t]=new b},e.setPrefetchData=function(t,r){e._prefetchData||(e._prefetchData={}),e._prefetchData[t]=r},e.clearPrefetchData=function(t){e._prefetchData&&e._prefetchData[t]&&delete e._prefetchData[t]},e.getAdditionalPostData=function(e,t){return e.isListDataRenderOptionChangeFeatureEnabled=!t||t(u),e.isSpotlightFeatureEnabled=!0,o.getAdditionalPostData(e)},e.createHashCode=function(t,r){return"listviewdataprefetch-"+e._hashCode(decodeURIComponent(t))+"-"+e._hashCode(r)},e._hashCode=function(e){var t=0;if(!e||0===e.length)return t;for(var r=0;r<e.length;r++){t=(t<<5)-t+e.charCodeAt(r),t&=t}return t},e.shouldLogError=!0,e}();!function(e){e[e.Loading=0]="Loading",e[e.Files=1]="Files",e[e.FilePicker=2]="FilePicker",e[e.FolderPicker=3]="FolderPicker",e[e.Photos=4]="Photos",e[e.TextFileEditor=5]="TextFileEditor",e[e.AccountChooser=6]="AccountChooser",e[e.StorageInfo=7]="StorageInfo",e[e.StorageOptions=8]="StorageOptions",e[e.AppData=9]="AppData",e[e.Error=10]="Error",e[e.SyncOnboarding=11]="SyncOnboarding",e[e.Share=12]="Share",e[e.Wedcs=13]="Wedcs",e[e.OneUp=14]="OneUp",e[e.PhotoPreferences=15]="PhotoPreferences",e[e.Embed=16]="Embed",e[e.SyncPlaceholders=17]="SyncPlaceholders",e[e.Restore=18]="Restore",e[e.WinPhoneBackup=19]="WinPhoneBackup",e[e.ValidatePermission=20]="ValidatePermission",e[e.RansomwareDetection=21]="RansomwareDetection",e[e.Settings=22]="Settings",e[e.Unlock=23]="Unlock",e[e.MobileAppUpsell=24]="MobileAppUpsell",e[e.Provisioning=25]="Provisioning",e[e.FileRequest=26]="FileRequest",e[e.CreateListPage=27]="CreateListPage"}(a||(a={}));var g=a,m=r("37b99d1e7f0c88452ea0"),_=r("c0ec8ed08a9b4b107886");function v(e){return new _.ApiUrlHelperBasic({webAbsoluteUrl:e.webAbsoluteUrl}).build()}function P(e){var t=e.webAbsoluteUrl,r=e.listOrItemFullUrl,a=t||new m.a(r).authority;if(!a)throw new Error("Could not determine the target webUrl to create an API call.");var n=v({webAbsoluteUrl:a});return n=!t&&r?n.method("SP.RemoteWeb",r).segment("Web"):n.segment("web")}var D="TryNewExperienceSingle";function C(e){var t,r=e.webAbsoluteUrl,a=e.listFullUrl,n=e.rootFolder,i=e.pageToken,o=e.filterParams,c=e.sortField,l=e.sortDir,d=e.viewId,u=e.viewPath,f=e.groupString,p=e.searchTerm,h=e.enableModernListSchemas,b=e.spPageFallbackWebAbsoluteUrl,w=new m.a(a),g=r||w.authority;if(!g)throw new Error("No web url available for GetList call");return t=!r||b&&b!==r?v({webAbsoluteUrl:b||g}).segment("SP.List.GetListDataAsStream").parameter("listFullUrl",a||""+new m.a(r).authority+n):function(e){var t=e.webAbsoluteUrl,r=e.listFullUrl,a=new m.a(r).path,n=P({webAbsoluteUrl:t,listOrItemFullUrl:r});return n=a?n.methodWithAliases("GetListUsingPath",{DecodedUrl:a}):n.segment("DefaultDocumentLibrary")}({webAbsoluteUrl:r,listFullUrl:a||""+new m.a(r).authority+n}).segment("RenderListDataAsStream"),i?(t=t.rawParameter(i.substring(1)),h&&(t=t.parameter(D,{raw:"TRUE"})),t.toString()):(n&&(a&&a.slice(-n.length)===n||(t=t.parameter("RootFolder",{raw:s.default.encodeURIComponent(n)}))),d&&(t=t.parameter("View",{raw:d})),u&&(t=t.parameter("ViewPath",{raw:u})),"string"==typeof f&&(t=t.parameter("IsGroupRender",{raw:"TRUE"}).parameter("DrillDown",1).parameter("GroupString",{raw:f})),void 0!==p&&(t=t.parameter("InplaceSearchQuery",p)),c&&(t=t.parameter("SortField",{raw:c}),l&&(t=t.parameter("SortDir",{raw:l}))),o&&(t=t.rawParameter(o)),h&&(t=t.parameter(D,{raw:"TRUE"})),t.toString())}var S="21";["_spPageContextInfo","__themeState__","mark","require","requirejs","define","_onErrorHandler","_perfMarks","_spModuleLink","__onePageContext","__stylesheet__","__globalSettings__"].concat(Object.keys(n));var F={id:!0,parent:!0,p:!0,embed:!0,sortField:!0,isAscending:!0,enableFeatures:!0,disableFeatures:!0,FolderCTID:!0};function O(e,t,r,a,n,i,m,_){if(i&&r&&((e=r.inputPageContextInfo).isSPO=!0,window._spPageContextInfo&&void 0!==window._spPageContextInfo.listBaseTemplate&&window._spPageContextInfo.listBaseTemplate<=0&&e.listBaseTemplate>0&&(window._spPageContextInfo.listBaseTemplate=e.listBaseTemplate)),e&&null!==window.location&&null!==window.location.search){var v=e.webTemplate,P=e.listBaseTemplate,D=!1,O="",R="",I=void 0===e.isSPO||e.isSPO;void 0!==e.webTitle&&(D=!!e.isSiteAdmin,O=e.serverRedirectedUrl,R=e.webServerRelativeUrl);var T=O&&O.indexOf("?")>=0?O.substring(O.indexOf("?")+1):"",A=window.location.search.slice(1)+(T?"&"+T:"");t||(t=c.deserializeQuery(A));var k="21"!==v,L=-1!==[101,109,115,119].indexOf(P),j="",E="";k?(E=e.listUrl,j=y(e,t,"listId",!0)):E=R+"/Documents";var x=t.listurl;if(k){if(!j&&!E)return;if(x&&e.viewId)return}else for(var M in t)if(!F[M])return;var B=function(e){var t=e.id,r=e.parent;return r?r.replace(/\/+$/,""):e.p===""+g.Embed&&t&&t.substring(0,t.lastIndexOf("/"))}(t),q=function(){var r,a=y(e,t,"viewId",!0),n=y(e,t,"webAbsoluteUrl",!0),i=t.id||t.RootFolder,o=!a&&k?y(e,t,"ViewPath",!0):void 0;if(y(e,t,"useFiltersInViewXml",!0)){var s=[];for(var c in t)0===c.lastIndexOf("Filter",0)&&s.push(c+"="+t[c]);r=s.join("&")}var l,d=y(e,t,"sortField");d&&(l="false"===(y(e,t,"isAscending")||"").toLowerCase()?"Desc":"Asc");return C({webAbsoluteUrl:n,listFullUrl:E,rootFolder:i,filterParams:r,sortField:d,sortDir:l,viewId:a,viewPath:o,enableModernListSchemas:!0})}(),H="";B&&(H=o.getViewXml({itemRefs:[t.id],requestMetaInfo:!0,recurseInFolders:!0,requestCommentFlags:n&&n(h),pageSize:1}));var N=!(k||!D||y(e,t,"sortField")||!n||!n(f)),V=void 0;B&&(V={viewXml:H,needsSchema:!0,needsParentInfo:!0,isListDataRenderOptionChangeFeatureEnabled:!n||n(u)});var W=y(e,t,"viewId",!0,!0),J=!!W&&l.default.normalizeLower(W,!1)!==l.default.normalizeLower(e.viewId,!1),G=V||{needsSchema:!0,needsContentTypes:k,needsQuickLaunch:n&&!n(p)&&k&&"64"!==v,needsSpotlight:k&&L,needsViewMetadata:k,viewXml:H,requestDatesInUtc:v===S&&n&&n(d),allowMultipleValueFilterForTaxonomyFields:!!I||void 0,needClientSideComponentManifest:J,needUpdatePageContext:!0,mergeDefaultView:N},z=y(e,t,"groupBy");z&&(G.groupByOverride=z,G.groupReplace=!1);var X,Q=w.getAdditionalPostData(G),K=w.createHashCode(q,Q);if(_&&m)m(K,"");else if(X=m?new b:w.initPrefetchData(K),window.DeferredListDataComplete=function(){U.bind(void 0,q)()},!U(q)){var $=new XMLHttpRequest;$.open("POST",q,!0),$.setRequestHeader("accept","application/json;odata=verbose"),$.setRequestHeader("Content-Type","application/json;odata=verbose");var Y=E?"listUrl="+s.default.encodeURIComponent(E):"list="+j;k&&(Y="NAVIGATIONSTRUCTURE, "+Y),$.setRequestHeader("X-SP-REQUESTRESOURCES",Y),a&&$.setRequestHeader("Authorization",a),$.onreadystatechange=function(){if(4===$.readyState&&!X.listData){var t=400;try{t=$.status}catch(e){}X.correlationId=$.getResponseHeader("SPRequestGuid"),X.responseCode=t,t<300&&(X.listData=$.responseText,X.serverDuration=Number($.getResponseHeader("SPClientServiceRequestDuration"))),i&&r&&r.onePagePrefetchCompleteCallback?r.onePagePrefetchCompleteCallback(t,$.responseText,function(r){e=r,X.completedCallback&&X.completedCallback(t)}):X.completedCallback&&X.completedCallback(t),m&&m(K,$.responseText)}},$.send(Q)}}}function U(e){if(window.g_payload&&window.g_listData){var t=w.createHashCode("ListContenTypes","ListContenTypes");w.initPrefetchData(t).listData=window.g_listData.ListContenTypes,t=w.createHashCode(e,JSON.stringify(window.g_payload)),window.DeferredListDataExpectedHash=t;var r=w.prefetchData(t);if(r)return r.listData=JSON.stringify(window.g_listData),r.deferredListData=!0,r.completedCallback&&r.completedCallback(0,!0),r.contentTypesCallback&&r.contentTypesCallback(),!0}return!1}function y(e,t,r,a,n){var i=t[a?r.toLowerCase():r]||!n&&e[r];if(i){var o=i.match(/\{(.*)\}/);return o?o[1]:i}return i}var R=r("a689a10faf924dde39cc"),I=r("eeb7e586e78ae434f9f6"),T={steps:{files_list_data_received:"list_data_received",write_to_db_Success:"written_to_IndexDB",failed_to_fetch_hashcode:"Failed_to_fetch_hashcode",prefetch_call_triggered:"prefetch_call_triggered"},errorMessage:{writeToDbFailed:"Failed to write to IndexDB",failToParseJSONResponse:"Failed to pass JSON response",prefetchErrorResponse:"Error response from prefetch call",cacheAlreadyPopulated:"Cache is already populated",cachePersistorLoadFailure:"Failed to get cache persistor instance",indexedDbFetchFailed:"Failed to fetch data from indexedDB"}},A={listBaseTemplate:101},k={sortField:"Modified",isAscending:"false"};function L(e){return!!e&&!!e.error}var j=r("a045aecb03dad90a1bba");function E(e,t,r,a,o,s){return Object(n.__awaiter)(this,void 0,void 0,function(){var c,l,d,u,f,p;return Object(n.__generator)(this,function(h){switch(h.label){case 0:return c=s||t,l=Object(n.__assign)({webAbsoluteUrl:e,listUrl:c},A),d=Object(n.__assign)({RootFolder:t},k),R.a.initialize(o),[4,x(l,d,a)];case 1:u=h.sent(),h.label=2;case 2:return h.trys.push([2,4,,5]),[4,q(u,a)];case 3:return h.sent(),a.incomplete({message:T.errorMessage.cacheAlreadyPopulated}),[2,Promise.resolve()];case 4:return h.sent(),f=function(e,t,r,a){var o=this;return new Promise(function(s,c){return Object(n.__awaiter)(o,void 0,void 0,function(){return Object(n.__generator)(this,function(n){return a.mark(T.steps.prefetch_call_triggered),O(e,t,void 0,"Bearer "+r,void 0,void 0,Object(i.partialRight)(N,a,s,c)),[2]})})})}(l,d,r,a),(p=j.a.getInstance()).populatePrefetchMemoryRecord(u,f),[2,f.then(function(){p.populatePrefetchMemoryRecord(u)}).catch(function(){p.removePrefetchRecord(u)})];case 5:return[2]}})})}function x(e,t,r){return Object(n.__awaiter)(this,void 0,void 0,function(){return Object(n.__generator)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,M(e,t)];case 1:return[2,a.sent()];case 2:return a.sent(),r.mark(T.steps.failed_to_fetch_hashcode),[2,void 0];case 3:return[2]}})})}function M(e,t){return new Promise(function(r,a){O(e,t,void 0,void 0,void 0,void 0,Object(i.partialRight)(B,r,a),!0)})}function B(e,t,r,a){if(e)return r(e);a()}function q(e,t){return Object(n.__awaiter)(this,void 0,void 0,function(){var r,a,i;return Object(n.__generator)(this,function(n){switch(n.label){case 0:if(!e)return[2,Promise.reject()];if((a=j.a.getInstance()).isPrefetchStateUpdated(e))return[2,Promise.resolve()];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,R.a.getInstance()];case 2:return r=n.sent(),[3,4];case 3:return i=n.sent(),t.fail({message:T.errorMessage.cachePersistorLoadFailure,reason:i}),[2,Promise.reject()];case 4:return n.trys.push([4,6,,7]),[4,H(e,r)];case 5:return n.sent()?(a.populatePrefetchMemoryRecord(e),[2,Promise.resolve()]):[2,Promise.reject()];case 6:return n.sent(),t.fail({message:T.errorMessage.indexedDbFetchFailed}),[2,Promise.reject()];case 7:return[2]}})})}function H(e,t){return Object(n.__awaiter)(this,void 0,void 0,function(){return Object(n.__generator)(this,function(r){return[2,t.getDataUsingKey(e,I.b.teams_requests)]})})}function N(e,t,r,a,i){var o=j.a.getInstance();try{var s=JSON.parse(t);if(L(s))return r.fail({reason:{code:s.error.code,message:T.errorMessage.prefetchErrorResponse}}),i();r.mark(T.steps.files_list_data_received),function(e,t,r){return Object(n.__awaiter)(this,void 0,void 0,function(){return Object(n.__generator)(this,function(a){switch(a.label){case 0:return[4,R.a.getInstance()];case 1:return[2,V(a.sent(),e,t,r)]}})})}(e,s,r).then(function(){o.populatePrefetchMemoryRecord(e),r.stop(),a(s)}).catch(function(e){r.fail({reason:e}),i()})}catch(e){r.fail({reason:T.errorMessage.failToParseJSONResponse}),i()}}function V(e,t,r,a){return Object(n.__awaiter)(this,void 0,void 0,function(){return Object(n.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e.persistData(t,r,I.b.teams_requests)];case 1:return n.sent(),[2,a.mark(T.steps.write_to_db_Success)];case 2:throw n.sent(),T.errorMessage.writeToDbFailed;case 3:return[2]}})})}r.d(t,"prefetchAndPersistListData",function(){return E}),r.d(t,"isError",function(){return L})}}]);