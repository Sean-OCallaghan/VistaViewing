var prefetch=function(e){function t(t){for(var r,o,i=t[0],a=t[1],s=0,u=[];s<i.length;s++)o=i[s],n[o]&&u.push(n[o][0]),n[o]=0;for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r]);for(c&&c(t);u.length;)u.shift()()}var r={},n={0:0};function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/",o.p=window.webpack_worker_runtime_public_path||o.p,o.oe=function(e){throw console.error(e),e};var i=this.webPackCDLJsonp=this.webPackCDLJsonp||[],a=i.push.bind(i);i.push=t,i=i.slice();for(var s=0;s<i.length;s++)t(i[s]);var c=a;return o(o.s="386b1e0dbc0940c5d784")}({"004e3511e392df2e6d63":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){return"function"==typeof Symbol},a=function(e){return i()&&Boolean(Symbol[e])},s=function(e){return a(e)?Symbol[e]:"@@"+e};function c(e,t){var r=e[t];if(null!=r){if("function"!=typeof r)throw new TypeError(r+" is not a function");return r}}function u(e){var t=e.constructor;return void 0!==t&&null===(t=t[s("species")])&&(t=void 0),void 0!==t?t:b}function l(e){return e instanceof b}function d(e){d.log?d.log(e):setTimeout(function(){throw e})}function p(e){Promise.resolve().then(function(){try{e()}catch(e){d(e)}})}function _(e){var t=e._cleanup;if(void 0!==t&&(e._cleanup=void 0,t))try{if("function"==typeof t)t();else{var r=c(t,"unsubscribe");r&&r.call(t)}}catch(e){d(e)}}function f(e){e._observer=void 0,e._queue=void 0,e._state="closed"}function h(e,t,r){e._state="running";var n=e._observer;try{var o=c(n,t);switch(t){case"next":o&&o.call(n,r);break;case"error":if(f(e),!o)throw r;o.call(n,r);break;case"complete":f(e),o&&o.call(n)}}catch(e){d(e)}"closed"===e._state?_(e):"running"===e._state&&(e._state="ready")}function g(e,t,r){if("closed"!==e._state){if("buffering"!==e._state)return"ready"!==e._state?(e._state="buffering",e._queue=[{type:t,value:r}],void p(function(){return function(e){var t=e._queue;if(t){e._queue=void 0,e._state="ready";for(var r=0;r<t.length&&(h(e,t[r].type,t[r].value),"closed"!==e._state);++r);}}(e)})):void h(e,t,r);e._queue.push({type:t,value:r})}}i()&&!a("observable")&&(Symbol.observable=Symbol("observable"));var v=function(){function e(t,r){o(this,e),this._cleanup=void 0,this._observer=t,this._queue=void 0,this._state="initializing";var n=new m(this);try{this._cleanup=r.call(void 0,n)}catch(e){n.error(e)}"initializing"===this._state&&(this._state="ready")}return n(e,[{key:"unsubscribe",value:function(){"closed"!==this._state&&(f(this),_(this))}},{key:"closed",get:function(){return"closed"===this._state}}]),e}(),m=function(){function e(t){o(this,e),this._subscription=t}return n(e,[{key:"next",value:function(e){g(this._subscription,"next",e)}},{key:"error",value:function(e){g(this._subscription,"error",e)}},{key:"complete",value:function(){g(this._subscription,"complete")}},{key:"closed",get:function(){return"closed"===this._subscription._state}}]),e}(),b=t.Observable=function(){function e(t){if(o(this,e),!(this instanceof e))throw new TypeError("Observable cannot be called as a function");if("function"!=typeof t)throw new TypeError("Observable initializer must be a function");this._subscriber=t}return n(e,[{key:"subscribe",value:function(e){return"object"==typeof e&&null!==e||(e={next:e,error:arguments[1],complete:arguments[2]}),new v(e,this._subscriber)}},{key:"forEach",value:function(e){var t=this;return new Promise(function(r,n){if("function"==typeof e)var o=t.subscribe({next:function(t){try{e(t,i)}catch(e){n(e),o.unsubscribe()}},error:n,complete:r});else n(new TypeError(e+" is not a function"));function i(){o.unsubscribe(),r()}})}},{key:"map",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(u(this))(function(r){return t.subscribe({next:function(t){try{t=e(t)}catch(e){return r.error(e)}r.next(t)},error:function(e){r.error(e)},complete:function(){r.complete()}})})}},{key:"filter",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(u(this))(function(r){return t.subscribe({next:function(t){try{if(!e(t))return}catch(e){return r.error(e)}r.next(t)},error:function(e){r.error(e)},complete:function(){r.complete()}})})}},{key:"reduce",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");var r=u(this),n=arguments.length>1,o=!1,i=arguments[1];return new r(function(r){return t.subscribe({next:function(t){var a=!o;if(o=!0,!a||n)try{i=e(i,t)}catch(e){return r.error(e)}else i=t},error:function(e){r.error(e)},complete:function(){if(!o&&!n)return r.error(new TypeError("Cannot reduce an empty sequence"));r.next(i),r.complete()}})})}},{key:"concat",value:function(){for(var e=this,t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];var o=u(this);return new o(function(t){var n=void 0;return function e(i){n=i.subscribe({next:function(e){t.next(e)},error:function(e){t.error(e)},complete:function(){0===r.length?(n=void 0,t.complete()):e(o.from(r.shift()))}})}(e),function(){n&&(n=void 0).unsubscribe()}})}},{key:"flatMap",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");var r=u(this);return new r(function(n){var o=[],i=t.subscribe({next:function(t){if(e)try{t=e(t)}catch(e){return n.error(e)}var i=r.from(t).subscribe({next:function(e){n.next(e)},error:function(e){n.error(e)},complete:function(){var e=o.indexOf(i);e>=0&&o.splice(e,1),a()}});o.push(i)},error:function(e){n.error(e)},complete:function(){a()}});function a(){i.closed&&0===o.length&&n.complete()}return function(){o.forEach(function(e){return e.unsubscribe()}),i.unsubscribe()}})}},{key:s("observable"),value:function(){return this}}],[{key:"from",value:function(t){var r="function"==typeof this?this:e;if(null==t)throw new TypeError(t+" is not an object");var n=c(t,s("observable"));if(n){var o=n.call(t);if(Object(o)!==o)throw new TypeError(o+" is not an object");return l(o)&&o.constructor===r?o:new r(function(e){return o.subscribe(e)})}if(a("iterator")&&(n=c(t,s("iterator"))))return new r(function(e){p(function(){if(!e.closed){var r=!0,o=!1,i=void 0;try{for(var a,s=n.call(t)[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var c=a.value;if(e.next(c),e.closed)return}}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}e.complete()}})});if(Array.isArray(t))return new r(function(e){p(function(){if(!e.closed){for(var r=0;r<t.length;++r)if(e.next(t[r]),e.closed)return;e.complete()}})});throw new TypeError(t+" is not observable")}},{key:"of",value:function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return new("function"==typeof this?this:e)(function(e){p(function(){if(!e.closed){for(var t=0;t<r.length;++t)if(e.next(r[t]),e.closed)return;e.complete()}})})}},{key:s("species"),get:function(){return this}}]),e}();i()&&Object.defineProperty(b,Symbol("extensions"),{value:{symbol:s("observable"),hostReportError:d},configurabe:!0})},"03f2c9f483943a5aa073":function(e,t,r){"use strict";(function(e){var r="object"==typeof e&&e&&e.Object===Object&&e;t.a=r}).call(this,r("698d75b157f24ae829cc"))},"044f282f6141fc605782":function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},"0bd0afb5c74547a322b4":function(e,t,r){"use strict";var n=r("03f2c9f483943a5aa073"),o="object"==typeof self&&self&&self.Object===Object&&self,i=n.a||o||Function("return this")();t.a=i},"0fd718ff208f632558c0":function(e,t,r){"use strict";r.r(t),r.d(t,"CDLSharedWorker",function(){return o});var n=r("c7e58922b074f46ef336"),o=r.n(n).a},"37514bca4dcc2a38a3c0":function(e,t,r){"use strict";r.r(t),r.d(t,"CDLWebWorker",function(){return o});var n=r("91537a72d48de18b3c5a"),o=r.n(n).a},"386b1e0dbc0940c5d784":function(e,t,r){"use strict";r.r(t);
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function o(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(a,s)}c((n=n.apply(e,t||[])).next())})}function s(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var c,u,l,d=r("9edef3da34909980d480");!function(e){e[e.Presenting=0]="Presenting",e[e.InCall=1]="InCall",e[e.InBroadcast=2]="InBroadcast",e[e.Interactive=3]="Interactive",e[e.Inactive=4]="Inactive",e[e.LongInactive=5]="LongInactive",e[e.Disabled=6]="Disabled",e[e.Disconnected=7]="Disconnected",e[e.Offline=8]="Offline",e[e.Uninitialized=9]="Uninitialized"}(c||(c={})),function(e){e.AppLogout="appLogout"}(u||(u={})),function(e){e[e.error=0]="error",e[e.warn=1]="warn",e[e.info=2]="info",e[e.verbose=3]="verbose"}(l||(l={}));var p,_,f,h,g;!function(e){e.Deserialization="Deserialization",e.Unknown="Unknown",e.Undefined="Undefined",e.TimedOut="TimedOut",e.AlreadyInitialized="AlreadyInitialized",e.NotImplemented="NotImplemented",e.NotPresent="NotPresent",e.Unauthorized="Unauthorized",e.AlreadyPresent="AlreadyPresent",e.FileLocked="FileLocked",e.SpQuotaReached="SpQuotaReached",e.FileAccessDenied="FileAccessDenied",e.FileNameTooLong="FileNameTooLong",e.InvalidResponse="InvalidResponse",e.RemoteOperationFailed="RemoteOperationFailed",e.UnknownRenderer="UnknownRenderer",e.UnknownRequestId="UnknownRequestId",e.UnknownDocumentOperation="UnknownDocumentOperation",e.InvalidRequestFormat="InvalidRequestFormat",e.MaxLimitReached="MaxLimitReached",e.ApolloError="ApolloError",e.InvalidInput="InvalidInput",e.ThirdPartyError="ThirdPartyError",e.AlreadyInProgress="AlreadyInProgress",e.NotInitialized="NotInitialized",e.UnhandledRuntimeException="UnhandledRuntimeException",e.Paused="Paused",e.PollCreationFailure="PollCreationFailure",e.PollRuntimeFailure="PollRuntimeFailure",e.PreviousFailure="PreviousFailure",e.FeatureNotSupported="FeatureNotSupported",e.IndexDbException="IndexDbException",e.FailedToFetch="FailedToFetch",e.FailedToUpdate="FailedToUpdate",e.FailedToGet="FailedToGet",e.UndefinedGlobalError="UndefinedGlobalError",e.UndefinedWindowError="UndefinedWindowError",e.UnhandledPromiseRejection="UnhandledPromiseRejection",e.DuplicateFound="DuplicateFound",e.Empty="Empty",e.MissingParameter="MissingParameter",e.MaxCallCountReached="MaxCallCountReached",e.PayloadTooBig="PayloadTooBig",e.BotError="BotError",e.WriteToStoreFailed="WriteToStoreFailed",e.CorruptedSyncState="CorruptedSyncState",e.Aborted="Aborted",e.Forbidden="Forbidden",e.WaitToFetchMore="WaitToFetchMore",e.AuthSafariITPBlocked="AuthSafariITPBlocked",e.AuthSafariITPBlockedAlways="AuthSafariITPBlockedAlways",e.ScriptLoadError="ScriptLoadError",e.ScriptEvalError="ScriptEvalError",e.ScriptCodeError="ScriptCodeError",e.CSSLoadError="CSSLoadError",e.Disabled="Disabled",e.AuthPopupWindowClosed="AuthPopupWindowClosed",e.AuthPopupWindowBlocked="AuthPopupWindowBlocked",e.NetworkOffline="NetworkOffline",e.DBCleanupError="DBCleanupError",e.ComponentLoadError="ComponentLoadError",e.ChunkLoadTimedOut="ChunkLoadTimedOut"}(p||(p={})),function(e){e.LazyComponentRenderer="LazyComponentRenderer",e.ShellService="ShellService",e.Timed="Timed",e.RequireStatus="RequireStatus",e.RequireStatusWithSsm="RequireStatusWithSsm",e.RejectHttpError="RejectHttpError",e.ServicesTasks="ServicesTasks",e.PostMessageClient="PostMessageClient",e.Authentication="Authentication",e.Apollo="Apollo",e.LongPoll="LongPoll",e.IndexDb="IndexDb",e.Tasks="Tasks",e.DataLayerClient="DataLayerClient",e.SettingsService="SettingsService",e.CSAService="CSAService",e.Commanding="Commanding",e.PeopleTargetingService="PeopleTargetingService",e.DistributionListService="DistributionListService",e.ErrorInRootLayout="ErrorInRootLayout",e.ItemUploadService="ItemUploadService",e.ItemDeleteService="ItemDeleteService"}(_||(_={})),function(e){e[e.OK=200]="OK",e[e.CREATED=201]="CREATED",e[e.ACCEPTED=202]="ACCEPTED",e[e.NO_CONTENT=204]="NO_CONTENT",e[e.NOT_MODIFIED=304]="NOT_MODIFIED",e[e.BAD_REQUEST=400]="BAD_REQUEST",e[e.NOT_AUTHORIZED=401]="NOT_AUTHORIZED",e[e.PAYMENT_REQUIRED=402]="PAYMENT_REQUIRED",e[e.FORBIDDEN=403]="FORBIDDEN",e[e.NOT_FOUND=404]="NOT_FOUND",e[e.CONFLICT=409]="CONFLICT",e[e.GONE=410]="GONE",e[e.REQUEST_ENTITY_TOO_LARGE=413]="REQUEST_ENTITY_TOO_LARGE",e[e.UNSUPPORTED_MEDIA_TYPE=415]="UNSUPPORTED_MEDIA_TYPE",e[e.EXPECTATION_FAILED=417]="EXPECTATION_FAILED",e[e.THROTTLED=429]="THROTTLED",e[e.SERVER_ERROR=500]="SERVER_ERROR",e[e.BAD_GATEWAY=502]="BAD_GATEWAY",e[e.SERVICE_UNAVAILABLE=503]="SERVICE_UNAVAILABLE",e[e.GATEWAY_TIMEOUT=504]="GATEWAY_TIMEOUT"}(f||(f={})),function(e){e.HTTP_2XX="2xx"}(h||(h={})),function(e){e[e.None=0]="None",e[e.Error=1]="Error",e[e.Warn=2]="Warn",e[e.Info=3]="Info",e[e.Debug=4]="Debug",e[e.Verbose=5]="Verbose",e[e.Max=6]="Max"}(g||(g={}));var v,m,b;!function(e){e[e.Initialization=0]="Initialization",e[e.DelayedInitialization=1]="DelayedInitialization"}(v||(v={})),function(e){e.Experience="Experience",e.Global="Global",e.User="User",e.UserAndExperience="UserAndExperience"}(m||(m={})),function(e){e[e.CreateSettings=0]="CreateSettings",e[e.CreateAuth=1]="CreateAuth",e[e.CreateAppState=2]="CreateAppState",e[e.CreateDiscovery=3]="CreateDiscovery",e[e.CreateEntityCommanding=4]="CreateEntityCommanding",e[e.CreateExternalCommandListener=5]="CreateExternalCommandListener",e[e.CreateGtmRegistry=6]="CreateGtmRegistry",e[e.CreateAsyncMediaAuth=7]="CreateAsyncMediaAuth",e[e.CreateLpc=8]="CreateLpc",e[e.CreateDataClient=9]="CreateDataClient",e[e.CreateRouting=10]="CreateRouting",e[e.CreateLocalStorage=11]="CreateLocalStorage",e[e.CreateWindow=12]="CreateWindow",e[e.UserSettings=13]="UserSettings",e[e.ConfigOverride=14]="ConfigOverride",e[e.Polyfills=15]="Polyfills",e[e.InitTelemetry=16]="InitTelemetry",e[e.LeakDetector=17]="LeakDetector",e[e.CreatePlatform=18]="CreatePlatform",e[e.EnableHostRouting=19]="EnableHostRouting",e[e.CreateLocationBinder=20]="CreateLocationBinder",e[e.InitSettingsPolicyProvider=21]="InitSettingsPolicyProvider",e[e.InitSettingsEcsProvider=22]="InitSettingsEcsProvider",e[e.CreateCommandHandler=23]="CreateCommandHandler",e[e.CreateI18NextWrapper=24]="CreateI18NextWrapper",e[e.InitInterprocessStore=25]="InitInterprocessStore",e[e.InitAuthenticationService=26]="InitAuthenticationService",e[e.DisableExperience=27]="DisableExperience"}(b||(b={}));var y,S=function(){function e(e,t){var r=this;this.logger=e,this.loggingContext=t,this.isCompleted=!1,this.subscriptions=new Set,this.observable$=new d(function(e){return r.subscriptions.add(e),function(){r.subscriptions.has(e)&&r.subscriptions.delete(e)}})}return Object.defineProperty(e.prototype,"observable",{get:function(){return this.observable$},enumerable:!0,configurable:!0}),e.prototype.subscribe=function(e){return this.isCompleted&&this.logger.error("Subject - tried to subscibe to a complete observable",this.loggingContext,p.NotPresent),this.observable$.subscribe(e)},e.prototype.onNext=function(e){this.subscriptions.forEach(function(t){t.next(e)})},e.prototype.onComplete=function(){this.isCompleted=!0,this.subscriptions.forEach(function(e){e.closed||e.complete()})},e.prototype.onError=function(e){this.isCompleted=!0,this.subscriptions.forEach(function(t){t.error(e)})},e}(),w=function(){function e(e){this._state=null,this._checkpoints=new Set,this._context={bootstrapServices:e.bootstrapServices,loggingContext:{hostRendererId:e.loggingContext.hostRendererId,component:"CDLGlobalState"}},this.subject=new S(e.bootstrapServices.logger,this._context.loggingContext)}return Object.defineProperty(e.prototype,"current",{get:function(){return this._state},enumerable:!0,configurable:!0}),e.prototype.setState=function(e,t){if(!e)throw new TypeError("state should have name specified");this.hasReachedCheckpoint(e)||(this._context.bootstrapServices.logger.log("Global state has reached checkpoint "+e,this._context.loggingContext),this._checkpoints.add(e),this._state=e,this.subject.onNext({newState:e,args:t}))},e.prototype.subscribe=function(e){return this.subject.subscribe(e)},e.prototype.hasReachedCheckpoint=function(e){if(!e)throw new TypeError("state should have name specified");return this._checkpoints.has(e)},e}();!function(e){e.syncEngine="syncEngine",e.graphql="graphql",e.control="control",e.database="database",e.auth="auth",e.diagnostics="diagnostics",e.appState="appState",e.appService="appService",e.tenantSwitch="tenantSwitch",e.workerHostSettings="workerHostSettings"}(y||(y={}));var k=function(){function e(e,t,r,n){var o=this;this._context=n,this._clients=new Map,t.forEach(function(t,i){var a=new t(function(t){return e(t)},r,n,i);o._clients.set(i,a)})}return Object.defineProperty(e.prototype,"cdlControlClient",{get:function(){return this._clients.get(y.control)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cdlDiagnosticsClient",{get:function(){return this._clients.get(y.diagnostics)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cdlAuthClient",{get:function(){return this._clients.get(y.auth)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cdlAppServiceClient",{get:function(){return this._clients.get(y.appService)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cdlAppStateClient",{get:function(){return this._clients.get(y.appState)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cdlWorkerHostSettingsClient",{get:function(){return this._clients.get(y.workerHostSettings)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cdlDatabaseClient",{get:function(){return this._clients.get(y.database)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cdlSyncEngineClient",{get:function(){return this._clients.get(y.syncEngine)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cdlGraphQLClient",{get:function(){return this._clients.get(y.graphql)},enumerable:!0,configurable:!0}),e.prototype.handleResponse=function(e){var t=this._clients.get(e.type);if(!t)throw this._context.bootstrapServices.logger.error("no client is configured for response type "+e.type,i({requestId:e.requestId,requestRendererId:e.rendererId,component:"CDLClientResponseRouter"},this._context.loggingContext),p.Unknown),new TypeError("no client is configured for response type "+e.type);return t.handleResponse(e)},e}();var C=function(e){return function(t,r,n){for(var o=-1,i=Object(t),a=n(t),s=a.length;s--;){var c=a[e?s:++o];if(!1===r(i[c],c,i))break}return t}}();var T=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n},A=r("0bd0afb5c74547a322b4"),E=A.a.Symbol,I=Object.prototype,R=I.hasOwnProperty,x=I.toString,P=E?E.toStringTag:void 0;var O=function(e){var t=R.call(e,P),r=e[P];try{e[P]=void 0;var n=!0}catch(e){}var o=x.call(e);return n&&(t?e[P]=r:delete e[P]),o},M=Object.prototype.toString;var D=function(e){return M.call(e)},L="[object Null]",j="[object Undefined]",q=E?E.toStringTag:void 0;var F=function(e){return null==e?void 0===e?j:L:q&&q in Object(e)?O(e):D(e)};var U=function(e){return null!=e&&"object"==typeof e},N="[object Arguments]";var W=function(e){return U(e)&&F(e)==N},B=Object.prototype,G=B.hasOwnProperty,H=B.propertyIsEnumerable,z=W(function(){return arguments}())?W:function(e){return U(e)&&G.call(e,"callee")&&!H.call(e,"callee")},J=Array.isArray,V=r("b8c08b527e4f22d848fd"),Q=9007199254740991,K=/^(?:0|[1-9]\d*)$/;var Y=function(e,t){var r=typeof e;return!!(t=null==t?Q:t)&&("number"==r||"symbol"!=r&&K.test(e))&&e>-1&&e%1==0&&e<t},$=9007199254740991;var X=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=$},Z={};Z["[object Float32Array]"]=Z["[object Float64Array]"]=Z["[object Int8Array]"]=Z["[object Int16Array]"]=Z["[object Int32Array]"]=Z["[object Uint8Array]"]=Z["[object Uint8ClampedArray]"]=Z["[object Uint16Array]"]=Z["[object Uint32Array]"]=!0,Z["[object Arguments]"]=Z["[object Array]"]=Z["[object ArrayBuffer]"]=Z["[object Boolean]"]=Z["[object DataView]"]=Z["[object Date]"]=Z["[object Error]"]=Z["[object Function]"]=Z["[object Map]"]=Z["[object Number]"]=Z["[object Object]"]=Z["[object RegExp]"]=Z["[object Set]"]=Z["[object String]"]=Z["[object WeakMap]"]=!1;var ee=function(e){return U(e)&&X(e.length)&&!!Z[F(e)]};var te=function(e){return function(t){return e(t)}},re=r("dbf5d091004dd78b9cad"),ne=re.a&&re.a.isTypedArray,oe=ne?te(ne):ee,ie=Object.prototype.hasOwnProperty;var ae=function(e,t){var r=J(e),n=!r&&z(e),o=!r&&!n&&Object(V.a)(e),i=!r&&!n&&!o&&oe(e),a=r||n||o||i,s=a?T(e.length,String):[],c=s.length;for(var u in e)!t&&!ie.call(e,u)||a&&("length"==u||o&&("offset"==u||"parent"==u)||i&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Y(u,c))||s.push(u);return s},se=Object.prototype;var ce=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||se)};var ue=function(e,t){return function(r){return e(t(r))}}(Object.keys,Object),le=Object.prototype.hasOwnProperty;var de=function(e){if(!ce(e))return ue(e);var t=[];for(var r in Object(e))le.call(e,r)&&"constructor"!=r&&t.push(r);return t};var pe=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},_e="[object AsyncFunction]",fe="[object Function]",he="[object GeneratorFunction]",ge="[object Proxy]";var ve=function(e){if(!pe(e))return!1;var t=F(e);return t==fe||t==he||t==_e||t==ge};var me=function(e){return null!=e&&X(e.length)&&!ve(e)};var be=function(e){return me(e)?ae(e):de(e)};var ye=function(){this.__data__=[],this.size=0};var Se=function(e,t){return e===t||e!=e&&t!=t};var we=function(e,t){for(var r=e.length;r--;)if(Se(e[r][0],t))return r;return-1},ke=Array.prototype.splice;var Ce=function(e){var t=this.__data__,r=we(t,e);return!(r<0||(r==t.length-1?t.pop():ke.call(t,r,1),--this.size,0))};var Te=function(e){var t=this.__data__,r=we(t,e);return r<0?void 0:t[r][1]};var Ae=function(e){return we(this.__data__,e)>-1};var Ee=function(e,t){var r=this.__data__,n=we(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};function Ie(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Ie.prototype.clear=ye,Ie.prototype.delete=Ce,Ie.prototype.get=Te,Ie.prototype.has=Ae,Ie.prototype.set=Ee;var Re=Ie;var xe=function(){this.__data__=new Re,this.size=0};var Pe=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r};var Oe=function(e){return this.__data__.get(e)};var Me,De=function(e){return this.__data__.has(e)},Le=A.a["__core-js_shared__"],je=(Me=/[^.]+$/.exec(Le&&Le.keys&&Le.keys.IE_PROTO||""))?"Symbol(src)_1."+Me:"";var qe=function(e){return!!je&&je in e},Fe=Function.prototype.toString;var Ue=function(e){if(null!=e){try{return Fe.call(e)}catch(e){}try{return e+""}catch(e){}}return""},Ne=/^\[object .+?Constructor\]$/,We=Function.prototype,Be=Object.prototype,Ge=We.toString,He=Be.hasOwnProperty,ze=RegExp("^"+Ge.call(He).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var Je=function(e){return!(!pe(e)||qe(e))&&(ve(e)?ze:Ne).test(Ue(e))};var Ve=function(e,t){return null==e?void 0:e[t]};var Qe=function(e,t){var r=Ve(e,t);return Je(r)?r:void 0},Ke=Qe(A.a,"Map"),Ye=Qe(Object,"create");var $e=function(){this.__data__=Ye?Ye(null):{},this.size=0};var Xe=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Ze="__lodash_hash_undefined__",et=Object.prototype.hasOwnProperty;var tt=function(e){var t=this.__data__;if(Ye){var r=t[e];return r===Ze?void 0:r}return et.call(t,e)?t[e]:void 0},rt=Object.prototype.hasOwnProperty;var nt=function(e){var t=this.__data__;return Ye?void 0!==t[e]:rt.call(t,e)},ot="__lodash_hash_undefined__";var it=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Ye&&void 0===t?ot:t,this};function at(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}at.prototype.clear=$e,at.prototype.delete=Xe,at.prototype.get=tt,at.prototype.has=nt,at.prototype.set=it;var st=at;var ct=function(){this.size=0,this.__data__={hash:new st,map:new(Ke||Re),string:new st}};var ut=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var lt=function(e,t){var r=e.__data__;return ut(t)?r["string"==typeof t?"string":"hash"]:r.map};var dt=function(e){var t=lt(this,e).delete(e);return this.size-=t?1:0,t};var pt=function(e){return lt(this,e).get(e)};var _t=function(e){return lt(this,e).has(e)};var ft=function(e,t){var r=lt(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};function ht(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}ht.prototype.clear=ct,ht.prototype.delete=dt,ht.prototype.get=pt,ht.prototype.has=_t,ht.prototype.set=ft;var gt=ht,vt=200;var mt=function(e,t){var r=this.__data__;if(r instanceof Re){var n=r.__data__;if(!Ke||n.length<vt-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new gt(n)}return r.set(e,t),this.size=r.size,this};function bt(e){var t=this.__data__=new Re(e);this.size=t.size}bt.prototype.clear=xe,bt.prototype.delete=Pe,bt.prototype.get=Oe,bt.prototype.has=De,bt.prototype.set=mt;var yt="__lodash_hash_undefined__";var St=function(e){return this.__data__.set(e,yt),this};var wt=function(e){return this.__data__.has(e)};function kt(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new gt;++t<r;)this.add(e[t])}kt.prototype.add=kt.prototype.push=St,kt.prototype.has=wt;A.a.Uint8Array;var Ct=E?E.prototype:void 0;Ct&&Ct.valueOf;Object.prototype.propertyIsEnumerable,Object.getOwnPropertySymbols;Object.prototype.hasOwnProperty;var Tt=Qe(A.a,"DataView"),At=Qe(A.a,"Promise"),Et=Qe(A.a,"Set"),It=Qe(A.a,"WeakMap"),Rt=Ue(Tt),xt=Ue(Ke),Pt=Ue(At),Ot=Ue(Et),Mt=Ue(It),Dt=F;(Tt&&"[object DataView]"!=Dt(new Tt(new ArrayBuffer(1)))||Ke&&"[object Map]"!=Dt(new Ke)||At&&"[object Promise]"!=Dt(At.resolve())||Et&&"[object Set]"!=Dt(new Et)||It&&"[object WeakMap]"!=Dt(new It))&&(Dt=function(e){var t=F(e),r="[object Object]"==t?e.constructor:void 0,n=r?Ue(r):"";if(n)switch(n){case Rt:return"[object DataView]";case xt:return"[object Map]";case Pt:return"[object Promise]";case Ot:return"[object Set]";case Mt:return"[object WeakMap]"}return t});Object.prototype.hasOwnProperty;var Lt="Expected a function";function jt(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(Lt);var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=e.apply(this,n);return r.cache=i.set(o,a)||i,a};return r.cache=new(jt.Cache||gt),r}jt.Cache=gt;var qt=jt,Ft=500;var Ut=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Nt=/\\(\\)?/g;!function(e){var t=qt(e,function(e){return r.size===Ft&&r.clear(),e}),r=t.cache}(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Ut,function(e,r,n,o){t.push(n?o.replace(Nt,"$1"):r||e)}),t});var Wt=E?E.prototype:void 0;Wt&&Wt.toString;function Bt(e,t,r,n,o,i){void 0===o&&(o=e+"::"+r+"::"+t);var a=new Error(o);return Object.assign(a,{context:e,subContext:r,reason:n,code:t,serverResponse:i})}function Gt(e,t){if(void 0===t&&(t=!0),null==e)return"";if("string"==typeof e)return e;try{return JSON.stringify(e,zt(Ht(t)))}catch(e){return"Stringifying error failed"}}var Ht=function(e){return void 0===e&&(e=!1),function(t,r){return r instanceof Error?i({name:r.name,message:r.message,stack:e?[]:("string"==typeof r.stack?r.stack:"").split("\n").map(function(e){return e.trim()}).filter(function(e){return!!e})},r):r}},zt=function(e){var t=new WeakSet;return function(r,n){if("object"==typeof n&&null!==n){if(t.has(n))return;t.add(n)}return e(r,n)}},Jt=(zt(Ht()),function(){function e(e,t,r,n){this._bootstrapServices=e,this._stateAndRequestHandlers=n,this._globalState=r,this._context={component:"CDLServer",hostRendererId:t},this._bootstrapServices.logger.log("Booted up server",this._context)}return e.prototype.handleRequest=function(e,t){var r=this,n=performance.now(),o=this._stateAndRequestHandlers.get(e.type);return o?o.stateMachine.isCompleted().then(function(a){var s=performance.now(),c={requestStartTime:n,stateMachineTime:s-n};return r._handleMessage(e,t,o.requestHandler,c,a).catch(function(t){return r._bootstrapServices.logger.error("Failed to process request due to error "+Gt(t),i(i({},r._context),{requestId:e.requestId,requestRendererId:e.rendererId,requestType:e.type}),p.Unknown)})}).catch(function(n){return r._returnCriticalError(e,t,"State machine initialization failed for request of type "+e.type+" with error "+Gt(n.errors),n.errorCode)}):this._returnCriticalError(e,t,"StateMachine and requestHandler not defined for request of type "+e.type)},e.prototype.start=function(){this._globalState.setState("Server_Start")},e.prototype._handleMessage=function(e,t,r,n,o){var i=this._decorateResponseCallback(e,t,n);return r.handle(e,i,{bootstrapServices:this._bootstrapServices,loggingContext:{hostRendererId:this._context.hostRendererId,requestId:e.requestId,requestRendererId:e.rendererId,requestType:e.type}},o)},e.prototype._decorateResponseCallback=function(e,t,r){return function(n){var o=performance.now()-r.requestStartTime,a=o-r.stateMachineTime;if(r=i(i({},r),{handlerResponseTime:a}),"graphql"===e.type){var s=n.response;s.extensions=i({},s.extensions),s.extensions.perfStats=i(i({},s.extensions.perfStats),{workerResponseTime:o}),t(i({requestId:e.requestId,rendererId:e.rendererId,type:e.type},n))}else t(i(i(i({requestId:e.requestId,rendererId:e.rendererId,type:e.type},n),r),{workerResponseTime:o}))}},e.prototype._returnCriticalError=function(e,t,r,n){return Promise.reject(t({rendererId:e.rendererId,requestId:e.requestId,status:"failure",type:e.type,response:{errors:r,errorCode:n},workerResponseTime:-1}))},e}());function Vt(e,t,r,n){var o=new k(function(e){return t.postMessageCallback(JSON.stringify(e))},t.clients,{rendererId:n},{bootstrapServices:e,loggingContext:{hostRendererId:n}}),i=new Jt(e,n,r.globalState,r.requestAndStateHandlers);return{workerServer:i,workerClientResponseRouter:o,onMessageCallback:function(t,r){var a=t.data&&JSON.parse(t.data);a&&a.rendererId===n?o.handleResponse(a):a&&a.status?e.logger.error("Received response with rendererId mismatch "+JSON.stringify(t),{component:"CDLPeer",hostRendererId:n},p.Unknown):a?i.handleRequest(a,function(e){return t=e,r(JSON.stringify(t));var t}):e.logger.error("Unknown message received that doesn't conform to CDL format "+JSON.stringify(t),{component:"CDLPeer",hostRendererId:n},p.Unknown)}}}function Qt(){var e={};return e.promise=new Promise(function(t,r){e.resolve=t,e.reject=r}),e}var Kt=function(){function e(){this._rendererRequestMap=new Map}return e.prototype.addRequest=function(e){if(!e.rendererId)throw new TypeError("No rendererId in request");if(!e.requestId)throw new TypeError("No requestId in request");var t=this._rendererRequestMap.get(e.rendererId);if(t||(t=new Map,this._rendererRequestMap.set(e.rendererId,t)),t.has(e.requestId))throw new Error("Request "+e.requestId+" for renderer "+e.rendererId+" already exists, somthing is off here");var r=Qt();return t.set(e.requestId,r),r.promise},e.prototype.reconcileResponse=function(e){if(!e.rendererId)throw new TypeError("No rendererId in response");if(!e.requestId)throw new TypeError("No requestId in response");if(!this._rendererRequestMap.has(e.rendererId))throw new Error("Response "+e.rendererId+" is not found in map");var t=this._rendererRequestMap.get(e.rendererId);if(!t)throw new Error("Request map for renderer  "+e.rendererId+" does not exist");var r=t.get(e.requestId);if(!r)throw new Error("Request "+e.requestId+" for renderer "+e.rendererId+" does not exist");"success"===e.status?r.resolve(e):r.reject(e),t.delete(e.requestId),0===t.size&&this._rendererRequestMap.delete(e.rendererId)},e}(),Yt=function(){function e(e){this.requestType=e,this.counter=0}return e.prototype.toString=function(){return(this.getOperationPrefix(this.currentCounterRequestType)||this.requestType)+"-"+this.counter},e.prototype.next=function(e){return this.safeIncrementCounter(),this.currentCounterRequestType=e,this.toString()},e.prototype.getOperationPrefix=function(e){switch(e){case"mutation":return"m";case"subscription":return"s";case"query":return"q";default:return e}},e.prototype.safeIncrementCounter=function(){return this.counter===e.MAX_COUNTER_VALUE&&(this.counter=0),this.counter++},e.MAX_COUNTER_VALUE=Number.MAX_SAFE_INTEGER,e}(),$t=function(){function e(e,t,r,n){var o=t.rendererId;this._context=r,this._loggingContext={component:"CDLClient",hostRendererId:o},this._rendererId=o,this._clientRequestType=n,this._postMessage=function(t){return e(t)},this._requestRegistrar=new Kt,this.requestId=new Yt(n)}return e.prototype.sendRequest=function(e){var t={rendererId:this._rendererId,requestId:this.requestId.next(),type:this._clientRequestType,payload:e},r=this._requestRegistrar.addRequest(t);return this._postMessage(t),r},e.prototype.handleResponse=function(e){var t=this;return new Promise(function(r,n){try{t._requestRegistrar.reconcileResponse(e),r()}catch(r){t._context.bootstrapServices.logger.error("Error occured on reconciling response "+r,i(i({},t._loggingContext),{requestId:e.requestId,requestRendererId:e.rendererId}),p.Unknown),n(r)}})},e}(),Xt="MainRenderer",Zt=function(e){function t(t,r,n,o){var i=r.rendererId;return e.call(this,t,{rendererId:i},n,o)||this}return o(t,e),t.prototype.sendFilteredAppStateRequest=function(t){var r=t.context.appState;return this._rendererId===Xt&&(t.context.appState=this.filterWorkerAppState(r)),e.prototype.sendRequest.call(this,t)},t.prototype.filterWorkerAppState=function(e){return e},t}($t),er=function(e){function t(t,r,n,o){var i=r.rendererId,a=e.call(this)||this;return a._context=n,a._loggingContext={hostRendererId:i,component:"CDLClient"},a.sendMessage=function(e){return t({requestId:e.requestId,rendererId:e.rendererId,payload:e.request,type:o})},a}return o(t,e),t.prototype.handleResponse=function(e){var t;return this._context.bootstrapServices.logger.log("Received message",i(i({},this._loggingContext),{requestId:e.requestId,requestRendererId:e.rendererId})),Promise.resolve(this.onResponseReceived({payload:{dataLayer:{rendererId:e.rendererId,requestId:e.requestId,data:e.response.data,errors:e.response.errors?e.response.errors:void 0,errorCode:null===(t=e.response)||void 0===t?void 0:t.errorCode,extensions:e.response.extensions}}}))},t}(function(){function e(){var e=this;this.onResponseReceived=function(t){if(e.onMessage){var r=e.transformLegacyClientFields(t.payload.dataLayer);e.onMessage(r)}}}return e.prototype.transformLegacyClientFields=function(e){return e.error&&(e.errors=e.error),e.extensions||(e.extensions={}),e.perfStats&&(e.extensions.perfStats=e.perfStats),e},e}());var tr,rr,nr,or=function(){function e(e,t,r,n){this._completionAwaiter=Qt(),this._context={bootstrapServices:n.bootstrapServices,loggingContext:i({component:"CDLStateMachine"},n.loggingContext)},this._actionStateMap=t,this._globalState=e,this._currentState=e.current,this._globalState.hasReachedCheckpoint(r)?this._transitionToNextState(r):this._subscribeToGlobalState()}return e.prototype.isCompleted=function(){return this._completionAwaiter.promise},e.prototype.errorStateMachine=function(e){this._unsubscribeStateTransition&&this._unsubscribeStateTransition.unsubscribe(),this._completionAwaiter.reject(e),e&&e.code===p.Disabled?this._context.bootstrapServices.logger.log(e.message,this._context.loggingContext):this._context.bootstrapServices.logger.error("State machine is erroring out: "+Gt(e),this._context.loggingContext,p.Unknown)},e.prototype.completeStateMachine=function(e){this._unsubscribeStateTransition&&this._unsubscribeStateTransition.unsubscribe(),this._completionAwaiter.resolve(e),this._context.bootstrapServices.logger.log("State machine is reaching completion",this._context.loggingContext)},e.prototype.execute=function(e,t,r){var n=this,o=e,i=this._actionStateMap.get(o);if(!i)return this._context.bootstrapServices.logger.log("State machine is transitioning from "+this._currentState+" to "+e+", skipping action invoke as none is defined",this._context.loggingContext),this._emitState(e,r);this._context.bootstrapServices.logger.log("State machine is invoking action for transition state "+this._currentState+" to "+e,this._context.loggingContext),i.action(t,r).then(function(t){n._context.bootstrapServices.logger.log("State machine is transitioning from "+n._currentState+" to "+e,n._context.loggingContext),n._emitState(e,t)}).catch(function(e){n.errorStateMachine(e)})},e.prototype._transitionToNextState=function(e,t){this._currentState=e,this.transitionState(e,t)},e.prototype._subscribeToGlobalState=function(){var e=this;this._unsubscribeStateTransition=this._globalState.subscribe({next:function(t){var r=t.newState,n=t.args;e._transitionToNextState(r,n)}})},e.prototype._emitState=function(e,t){this._globalState.hasReachedCheckpoint(e)?this._transitionToNextState(e,t):(this._unsubscribeStateTransition||this._subscribeToGlobalState(),this._globalState.setState(e,t))},e}(),ir=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.transitionState=function(e,t){switch(e){case"authLoaded":this.execute("authServiceInjected",t,void 0);break;case"authServiceInjected":this.completeStateMachine(!0)}},t}(or),ar=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.transitionState=function(e,t){switch(e){case"appService:Loaded":this.execute("appService:Injected",t,void 0);break;case"appService:Injected":this.completeStateMachine(!0)}},t}(or),sr=function(){function e(e){this._componentName=e,this._handlerMap=new Map}return e.prototype.addHandlers=function(e){var t=this;e.forEach(function(e){t._handlerMap.set(e.requestType,e.handlerFunc)})},e.prototype.handle=function(e,t,r){for(var n=this,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];var s=e.payload;return new Promise(function(e,a){var c=n._handlerMap.get(s.requestOperationtype);if(!c){r.bootstrapServices.logger.error("No handler found for request type "+s.requestOperationtype,i({component:n._componentName},r.loggingContext),p.NotImplemented);var u={statusMsg:"Unknown request type: "+s.requestOperationtype,data:void 0},l=n._constructResponseMessage(u,"failure");return t(l),a(l)}c.apply(void 0,function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n}([s,r],o)).then(function(r){return e(t(n._constructResponseMessage(r,"success")))}).catch(function(e){var r=n._constructResponseMessage(e,"failure");return t(r),a(r)})})},e.prototype._constructResponseMessage=function(e,t){return e&&"function"==typeof e.toString&&e instanceof Error&&(e=e.toString()),{status:t,response:e}},e.onHandlerError=function(e,t,r,n,o){e.bootstrapServices.logger.error(r,i({component:o},e.loggingContext),t);var a={statusMsg:n,data:void 0};return Promise.reject(a)},e}();!function(e){e.AadGetToken="aadGetToken",e.AadGetCurrentUser="aadCurrentUser",e.AadIsCurrentUserAnonymous="aadIsCurrentUserAnonymous",e.AadClearCache="aadClearCache",e.StartupApiToken="startupApiToken",e.GetSkypeTokens="getSkypeTokens",e.GetUserDetails="getUserDetails"}(tr||(tr={})),function(e){e.AppStart="app_start",e.CoreInitialize="core_initialize",e.DomLoadingStart="dom_loading_start",e.DownloadAndParse="download_and_parse",e.DynamicImport="dynamic_import",e.ExperienceReady="experience_ready",e.PhasedRender="phased_render",e.ResolveMainImports="resolve_main_imports",e.RestorePersistedWindows="restore_persisted_windows",e.WindowLaunchTime="window_launch_time",e.CommandEvent="commandEvent",e.AcquireToken="acquire_token",e.AcquireTokenInBackground="acquire_token_in_background",e.AppCtxProviderWait="app_ctx_provider_wait",e.CentralDataLayerSubscription="cdl_subscription_agg",e.CentralDataLayeRequest="cdl_request",e.CentralDataLayerWorkerStartup="cdl_worker_startup",e.CentralDataLayerWorkerManagerStartup="cdl_worker_manager_startup",e.CentralDataLayerDataStoreCreate="cdl_data_store_create",e.CentralDataLayerDataStoreRemoveAllData="cdl_data_store_remove_all_data",e.ComposeDisabled="compose_disabled",e.ChatSendMessage="chat_send_message",e.GetAuthUser="get_auth_user",e.GetSkypeToken="get_skype_token",e.IndexedDBFetch="indexed_db_fetch",e.LongPollRecovery="long_poll_recovery",e.LongPollError="long_poll_error",e.QueryExecution="query_exec",e.SubscriptionCloseExecution="subscription_close_exec",e.SubscriptionOpenExecution="subscription_open_exec",e.FatalError="fatal_error",e.GlobalWindowError="global_window_error",e.UnhandledRejection="unhandled_rejection_error",e.GarbageCollection="garbage_collection",e.AuthHandlerRequest="auth_handler_request",e.RenderChatList="render_chat_list",e.RenderComposeChat="render_compose_chat",e.RenderCallingDefault="render_calling_default",e.RenderCallsTab="render_calls_tab",e.RenderCallingJoin="render_calling_join",e.RenderCallingScreenManager="render_calling_screen_manager",e.RenderCallingPreJoin="render_calling_prejoin",e.RenderCallingScreen="render_calling_screen",e.I18nMissingInterpolationHandler="i18n_missing_interpolation_handler",e.I18nMissingKeyHandler="i18n_missing_key_handler",e.I18nNamespaceLoad="i18n_namespace_load",e.I18nGetLocaleInfo="i18n_get_locale_info",e.I18nFallbackToIntl="i18n_fallback_to_intl",e.I18nLangFallback="i18n_lang_fallback",e.AllSearch="search_all",e.MessageSearch="search_message",e.FilesSearch="search_files",e.PeopleSearch="search_people",e.SearchStart="search_start",e.RenderFileViewer="render_file_viewer",e.RenderFileEmailViewer="render_file_email_viewer",e.MainImportToDomContentLoaded="main_import_to_dom_content_loaded",e.FilePreviewLayoutToJsApiScriptLoad="file_preview_layout_to_jsapi_script_load",e.JsApiScriptLoad="jsapi_script_load",e.JsApiFirstStep="jsapi_first_step",e.JsApiSecondStep="jsapi_second_step",e.FileRedeem="documents_file_redeem",e.ChatListFiltering="chat_list_filtering",e.SendFeedback="send_feedback",e.FetchPersonalSiteInfo="fetch-personal-site-info",e.CreateFileChiclet="documents_create_file_chiclet_on_link_paste",e.AsyncLinkToChiclet="documents_async_link_to_chiclet",e.RenderFilesPersonalPicker="render_files_personal_picker",e.FilesPersonalPicker="files_personal_picker",e.FileUploadChatPicker="documents_upload_file_chat_file_picker",e.FileUploadChatConflict="documents_upload_file_chat_conflict_dialog",e.FileUploadChatDragNDrop="documents_upload_file_chat_drag_and_drop",e.FileRemovalChat="documents_remove_file_chat",e.FileAttachChat="documents_attach_file_chat",e.FileUploadMeetingPicker="documents_upload_file_meeting_file_picker",e.FileUploadMeetingConflict="documents_upload_file_meeting_conflict_dialog",e.FileUploadMeetingDragNDrop="documents_upload_file_meeting_drag_and_drop",e.FileRemovalMeeting="documents_remove_file_meeting",e.FileAttachMeeting="documents_attach_file_meeting",e.FilesAMSImageUpload="documents_ams_image_upload",e.FileChicletDefaultPermission="documents_share_link_chiclet_default_permission",e.FileChicletExistingPermission="documents_share_link_chiclet_existing_permission",e.FileSharingPermissionDialog="documents_share_link_permission_dialog",e.FileSharingCopyLinkDialog="documents_share_link_copy_dialog",e.FileOpenInDesktopApp="documents_action_open_office_file_app",e.FileDownload="documents_action_download_file",e.FileOpenOnline="documents_action_open_file_online",e.FileEditInTeams="documents_action_edit_file_in_teams",e.MeetingOptionsCore="meeting_options_core",e.MeetingOptionsChanged="meeting_options_changed",e.MeetingOptionsStart="meeting_options_start",e.MeetingOptionsGet="meeting_options_get",e.MeetingOptionsSet="meeting_options_set",e.AmsImageApiLoad="ams_image_api_load",e.AmsImageBrowserLoad="ams_image_browser_load",e.AmsImageUpload="ams_image_upload",e.OnDemandTranslation="on_demand_translate_message",e.AutomaticTranslation="automatic_translate_message",e.DetectLanguagePrompt="show_switch_language_prompt",e.AudioFileDownload="audio_file_download",e.PrivateChatPolicyDefined="private_chat_policy_defined",e.ATPGetPolicy="atp_get_policy",e.ATPGetUrlReputation="atp_get_url_reputation",e.PeoplePickerRemote="people_picker_load_results",e.PeoplePickerInstantScd="people_picker_load_results_scd",e.PeoplePickerCache="people_picker_load_results_clientonly",e.PeoplePickerResolveUserRemote="people_picker_resolve_user_remote",e.PeoplePickerPstnAssignmentRemote="people_picker_pstn_resolve_user_remote",e.PeoplePicker3S="people_picker_3s",e.PeoplePickerAAD="people_picker_aad",e.PeoplePickerIDB="people_picker_indexeddb",e.PeoplePickerResolveUserOnSelection="people_picker_resolve_user_on_selection",e.PeoplePickerOffNetwork="people_picker_load_results_off_network",e.CreateWiki="wikiv2_create_wiki",e.LoadWiki="wikiv2_load_wiki",e.DeleteWiki="wikiv2_delete_wiki",e.SavePageTitleWiki="wikiv2_save_page_title",e.LockSectionWiki="wikiv2_lock_section",e.SaveSectionWiki="wikiv2_save_section",e.AddPageWiki="wikiv2_add_page",e.DeletePageWiki="wikiv2_delete_page",e.MovePageWiki="wikiv2_move_page",e.MoveSectionWiki="wikiv2_move_section",e.DeleteSectionWiki="wikiv2_delete_section",e.ForceUnlockWiki="wikiv2_force_unlock",e.AddSectionWiki="wikiv2_add_section",e.DiscardSectionWiki="wikiv2_discard_section",e.LoadPageWiki="wikiv2_load_page",e.FocusSectionWiki="wikiv2_focus_section",e.LoadPagesForSidebarWiki="wikiv2_load_pages_for_sidebar",e.LoadPageWithoutSectionWiki="wikiv2_load_page_without_section",e.LoadSectionWiki="wikiv2_load_section",e.SyncJobScheduler="sync_job_scheduler",e.NoOpSyncJob="noop_sync_job",e.MessageSyncJob="message_sync_job",e.RelatedMessageSyncJob="related_message_sync_job",e.StartupSyncJob="startup_sync_job",e.ThreadDetailsSyncJob="thread_details_sync_job",e.BatchedThreadDetailsSyncJob="batched_thread_details_sync_job",e.ReplyChainSyncJob="replychain_sync_job",e.PersistencePruningJob="persistence_pruning_job",e.RetentionPruningJob="retention_pruning_job",e.ActivityFeedPruningJob="activity_feed_pruning_job",e.InMemoryCleanupJob="inmemory_cleanup_job",e.MessageSyncWorkflow="message_sync_workflow",e.DeltaSyncWorkflow="delta_sync_workflow",e.ConversationSyncWorkflow="conversation_sync_workflow",e.ThreadDetailsWorkflow="thread_details_workflow",e.ReplyChainWorkflow="reply_chain_workflow",e.ExtendHistoryWorkflow="extend_history_workflow",e.RelatedMessageSyncWorkflow="related_message_sync_workflow",e.MaintenanceWorkflow="maintenance_workflow",e.OnActiveConversationStrategy="on_active_conversation_strategy",e.OnStartupOrIntervalStrategy="on_startup_or_interval_strategy",e.OnLoadMoreStrategy="on_load_more_strategy",e.OnLongPollReceivedStrategy="on_long_poll_received_strategy",e.OnAppStateActiveStrategy="on_app_state_active_strategy",e.OnAppStateInactiveStrategy="on_app_state_inactive_strategy",e.OnForceRunMaintenanceWorkflow="on_force_run_maintenance_workflow",e.OnPrefetchReplyChainsFromDb="on_prefetch_reply_chains_from_db",e.ReplyChainManagerGetReplyChains="reply_chain_manager_get_reply_chains",e.ReplyChainManagerGetReplyChain="reply_chain_manager_get_single_reply_chain",e.ReplyChainManagerGetReplyChainsByKeys="reply_chain_manager_get_reply_chains_by_keys",e.GetTeamsChannelsFromIndexedDB="get_teams_channels_from_indexeddb",e.PutLegacyMessagesResolver="put_legacy_messages_resolver",e.PutConversationsResolver="put_conversations_resolver",e.ResolveEditClientLieResolver="resolve_edit_client_lie_resolver",e.OutOfOrderMessages="gap_detection_out_of_order_messages",e.MissingMessages="gap_detection_missing_messages",e.ArrivedAfterOutOfOrderWaitTime="gap_detection_messages_arrived_after_outoforderwaittime",e.MessagesGapAboveThreshold="gap_detection_messages_gap_above_threshold",e.OnAsyncIterableObserverOverflow="on_async_iterable_observer_overflow",e.EcsFetch="ecs_provider_fetch",e.IPCPolicyFetch="policy_service_fetch_ipc",e.NetworkPolicyFetch="policy_service_fetch_network",e.UpToEditBegin="messaging_up_to_edit_message",e.SmsDeliveryReportFailure="sms_delivery_report_failure",e.ExtTaskModuleSubmitAction="ext_task_module_submit_action",e.ExtTaskModuleBotPreviewAction="ext_task_module_bot_preview_action",e.ExtTaskModuleAuth="ext_task_module_auth",e.ExtTaskModule="ext_task_module",e.ExtTaskModuleFetch="ext_task_module_fetch",e.ExtTaskModuleUpdateResult="ext_task_module_update_result",e.ExtMessageExtensionQueryCommand="ext_me_queryCommand",e.ExtMessageExtensionAuthAndConfig="ext_me_authAndConfig",e.ExtMessageExtensionUninstallApp="ext_me_uninstall_app",e.ExtBotsInvoke="ext_bots_invoke",e.ExtBotsSignIn="ext_bots_sign_in",e.ExtBotsMessageBack="ext_bots_messageback",e.ExtBotsCardActionChatSendMessage="ext_bots_card_action_chat_send_message",e.ExtBotsCardFetchTaskModule="ext_bots_card_fetch_task_module",e.ExtBotsCardTaskSubmit="ext_bots_card_task_submit",e.ExtBotsTokenExchange="ext_bots_token_exchange",e.ExtBotsCardO365HttpPOST="ext_bots_actionable_card_http_post",e.ExtBotsFileUpload="ext_bots_file_upload",e.ExtBotsPinAsTab="ext_bots_pinAsTab",e.ExtBotsSsoAadAuthTokenRequest="ext_bots_sso_aad_auth_token_request",e.ExtBotsSsoAadAuthTokenInvoke="ext_bots_sso_aad_auth_token_invoke",e.ExtBotsSsoSignInAuthTokenRequest="ext_bots_sso_sign_in_auth_token_request",e.ExtBotsSsoSignInAuthTokenInvoke="ext_bots_sso_sign_in_auth_token_invoke",e.PlatformTabLoading="platform_tab_loading",e.PlatformTabWebviewCreation="platform_tab_webview_creation",e.WebsiteTabWebviewCreation="website_tab_webview_creation",e.PlatformTabSdkGetAuthToken="platform_tab_sdk_get_auth_token",e.PlatformTabSdkGetContext="platform_tab_sdk_get_context",e.PlatformTabSdkGetUser="platform_tab_sdk_get_user",e.PlatformTabSdkAuthenticationAuthenticate="platform_tab_sdk_authentication_authenticate",e.ExtAppDefinitionForMECard="ext_app_definition_for_me_card",e.ExtAppDefinitionsForBotCard="ext_app_definitions_for_bot_card",e.ExtInstalledApp="ext_installed_app",e.ExtInstalledApps="ext_installed_apps",e.ExtInstalledAppsV2="ext_installed_apps_V2",e.ExtInstalledAppsUpdateEventSuccess="ext_installed_apps_update_event_success",e.ExtInstalledAppsUpdateEventFailure="ext_installed_apps_update_event_failure",e.ExtInstalledAppsUpdateEventV2Success="ext_installed_apps_update_event_V2_success",e.ExtInstalledAppsUpdateEventV2Failure="ext_installed_apps_update_event_V2_failure",e.RenderOutlookPreview="render_outlook_preview",e.RenderShareForm="render_share_form",e.ShareFormErrorBoundary="share_form_error_boundary",e.ShareFormFatalError="share_form_fatal_error",e.STTOutlookAddInStartup="stt_outlook_add_in_startup",e.STTOutlookAuthStrap="stt_outlook_auth_strap",e.STTOutlookPopulateUsage="stt_outlook_populate_usage",e.STTRecentChannels="stt_recent_channels",e.STTRecentChats="stt_recent_chats",e.STTRecentRecipients="stt_recent_recipients",e.STTOutlookZeroStateSuggestions="stt_outlook_zero_state_suggestions",e.SubmitShareForm="submit_share_form",e.GetOngoingScenario="get_ongoing_scenario",e.AdjacentRoomBanner="adjacent_room_banner",e.ChatPaneFromCallRender="chat_pane_from_call_render",e.ShareTrayRender="share_tray_render",e.ShareTrayPreviewsLatency="share_tray_previews_latency",e.RosterPanelRender="roster_panel_render",e.CreateMeetingNotes="create_meeting_notes",e.UbarMicrophoneRerendered="toggle_mute_latency",e.RemoteMuteRender="server_mute_latency",e.ChangeRoleRender="change_role_latency",e.RemoveParticipantRender="remove_participant_latency",e.NudgeParticipantRender="nudge_participant_latency",e.ParticipantVbssLatency="participant_vbss_latency",e.LowerOtherParticipantsHandLatency="lower_other_participants_hand_latency",e.CallMerge="call_merge",e.OpenShareInviteDialog="openShareInviteDialog",e.VideoStreamStopped="video_stream_stopped",e.VideoPreview="video_preview",e.CallHistoryFilterSelected="call_history_filter_selected",e.CallHistoryFetch="call_history_fetch",e.VoicemailsFetch="voicemails_fetch",e.FetchContactList="fetch_contact_list",e.FetchSpeedDialContactInfo="fetch_speed_dial_contact_info",e.StartCall="start_call",e.ExtBotProfilePictureUrl="ext_bot_profile_picture_url",e.VirtualListInitialStableView="vl_initial_stable_view",e.VirtualListLoadMore="vl_load_more",e.VirtualListNewRenderWindow="vl_new_render_window",e.VirtualListScrollToBottom="vl_scroll_to_bottom",e.InstallAppMessageExtensionJit="ext_install_app_message_ext_jit",e.InstallAppResultCacheUpdate="ext_install_app_result_cache_update",e.AppProfileCardGetAppDefinition="app_profile_card_get_app_definition",e.LaunchLmsIntegration="launch_lms_integration",e.EnableSchoolDataSyncForCourse="enable_school_data_sync_for_course",e.GetTeamsForCourse="get_teams_for_course",e.LmsIntegrationErrorBoundary="lms_integration_error_boundary",e.AppBasedLinkInstall="app_based_link_install",e.AppBasedLinkAuthOrConfig="ext_do_auth_or_config_appbasedlink",e.GetAppPreviewResult="ext_get_app_preview_result_appbasedlink",e.GetDefaultUrlPreview="ext_get_default_url_preview_appbasedlink",e.FluidLoadCompose="fluid_load_compose",e.FluidLoadMessage="fluid_load_message",e.FluidLoadPaste="fluid_load_paste",e.OnBehalfOfUserAttribution="on_behalf_of_user_attribution",e.ChatsByTitleSearch="chats_by_title_search",e.ChatsByMembersSearch="chats_by_members_search",e.BroadcastAttendeePerformance="broadcast_attendee_performance",e.BroadcastAttendeeLoadSdnPluginScript="broadcast_attendee_load_sdn_plugin_script",e.BreakoutRoomCreateDialog="breakout_room_create_dialog",e.BreakoutRoomButton="breakout_room_button",e.BreakoutRoomAnnouncement="breakout_room_announcement",e.StartBotView="start_bot_view",e.ExtensionOpen="extension_open",e.ExtensionClose="extension_close",e.TeamSettingsTabLoad="teamdashboard_settingstab_load",e.RenewTeam="renew_team",e.ResetTeamJoinCode="reset_team_join_code",e.BiometricVoiceEnrollment="voice_enrollment"}(rr||(rr={})),function(e){e.AppCacheMainJS="appcache_main",e.AppCacheVendorJS="appcache_vendor",e.ClickTimeAction="click-time-action",e.DownloadScripts="download_scripts",e.DownloadMainJs="main",e.DownloadVendorJs="vendor",e.EncodedBodySizeMainJS="encoded_body_size_main",e.EncodedBodySizeVendorJS="encoded_body_size_vendor",e.FetchData="fetch_data",e.FetchQuerySend="fetch_query_send",e.FetchWait="fetch_wait",e.FetchWaitIpc="fetch_wait_ipc",e.FetchWaitWorker="fetch_wait_worker",e.FetchProcessResponse="fetch_process_response",e.GetAuthUser="get_auth_user",e.InitCoreServices="init_core_services",e.InitCoreServicesComplete="init_core_services_complete",e.Pause="pause",e.RenderShareForm="render_share_form",e.Resume="resume",e.Start="start",e.Stop="stop",e.QueryResult="query_result",e.CdlWorkerBootstrapped="cdl_worker_bootstrapped",e.CdlWorkerManagerLoaded="cdl_worker_manager_loaded",e.CdlWorkerManagerHealthChecked="cdl_worker_manager_health_checked",e.PlatformTabInitInvoke="platform_tab_initialize_invoked",e.PlatformTabAppLoadedInvoke="platform_tab_appLoaded_invoked",e.PlatformTabNotifySuccessInvoke="platform_tab_success_invoked",e.PlatformTabNotifyFailureInvoke="platform_tab_failure_invoked",e.Critical="critical",e.PostCritical="post_critical",e.Complete="complete",e.BeginWindowCreation="begin_window_creation",e.CallingContext="calling_context",e.EndWindowCreation="end_window_creation",e.PlatformFetchAppDefinition="platform_fetch_app_definition",e.PlatformFetchTabInfo="platform_fetch_tab_information",e.RenderBaseApp="render_base_app",e.RenderCallingScreen="render_calling_screen",e.RenderChatList="render_chat_list",e.RenderChatPane="render_chat_pane",e.RenderMessages="render_messages",e.RenderPlatformApp="render_platform_app",e.RenderPrejoin="render_prejoin",e.RenderProviders="render_providers",e.Unknown="unknown",e.WindowContextProvider="window_context_provider",e.WindowCreated="window_created",e.STTDialogTriggered="stt_dialog_triggered",e.STTOutlookAuthStrapOpen="stt_outlook_auth_strap_open",e.STTOutlookCallbackTokenComplete="stt_outlook_callback_token_complete",e.STTOutlookMTCachedTokenComplete="stt_outlook_mt_cached_token_complete",e.STTOutlookOpen="stt_outlook_open",e.STTOutlookSSOComplete="stt_outlook_sso_complete",e.ReactSerpLoaded="react_serp_loaded",e.RequestSent3S="request_sent_3s",e.ResponseSuccess3S="response_success_3s",e.RequestSentMT="request_sent_mt",e.ResponseSuccessMT="response_success_mt",e.UIResultsProcessed="render_begin",e.FetchedFromServiceCache="fetched_from_cache",e.RequestHeaderStart="request_header_start",e.HeaderRendered="header_rendered",e.FiltersRendered="filters_rendered",e.OnBehalfOfUserResolveNameFromMessage="onbehalfof_user_resolve_name_from_message",e.OnBehalfOfUserResolveNameFromUserQuery="onbehalfof_user_resolve_name_from_user_query",e.RoomCoordinatesQuery="room_coordinates_query",e.CreateBreakoutRoomsMutation="create_breakout_rooms_mutation",e.ObtainCreateBreakoutRoomsMutationFn="obtain_create_breakout_rooms_mutation_fn",e.BreakoutRoomCreateDialogOpen="breakout_room_create_dialog_open",e.ListBreakoutRoomsQuery="list_breakout_rooms_query",e.SendMessageMutation="send_message_mutation",e.SendMessageResultProcessing="send_message_result_processing",e.MessageIdFetched="messageId_retrieved",e.MeetingRoleLoaded="meeting_role_loaded",e.PostVoiceDataToSubstrate="post_voice_data_to_substrate",e.RetrieveCognitionToken="retrieve_cognition_token",e.StartVoiceRecognition="start_voice_recognition",e.StopVoiceRecognition="stop_voice_recognition",e.ExtAppsProcessed="ext_apps_processed",e.ExtAppsFetched="ext_apps_fetched",e.ExtAppsFetchedPersonalScope="ext_apps_fetched_personal_scope",e.ExtAppsFetchedGroupScope="ext_apps_fetched_group_scope",e.MicPropsChanged="mic_prop_changed",e.ShareLinkRedeem="share_link_redeem"}(nr||(nr={}));var cr,ur,lr,dr=function(){function e(t){this._requestUtility=new sr("CDLAuthHandler");var r=[];r=t===Xt?[{requestType:tr.AadGetToken,handlerFunc:e.getAadTokensAngular},{requestType:tr.AadGetCurrentUser,handlerFunc:e.getUserInformationAngular},{requestType:tr.AadIsCurrentUserAnonymous,handlerFunc:e.getUserIsAnonymousAngular},{requestType:tr.GetSkypeTokens,handlerFunc:e.getSkypeTokensAngular},{requestType:tr.GetUserDetails,handlerFunc:e.getUserDetailsAngular}]:[{requestType:tr.AadGetToken,handlerFunc:e.getAadTokens},{requestType:tr.AadGetCurrentUser,handlerFunc:e.getUserInformation}],this._requestUtility.addHandlers(r)}return e.prototype.injectNgAuthenticationService=function(e){var t=this;return new Promise(function(r){if(!e)throw new TypeError("Cannot inject authentication service that is not defined");if(t._authenticationService)throw new TypeError("injectedAuthenticationService has been called again, even though it's already initialized");return t._authenticationService=e,r()})},e.prototype.injectAuthenticationService=function(e){var t=this;return new Promise(function(r){if(!e)throw new TypeError("Cannot inject authentication service that is not defined");if(t._authenticationService)throw new TypeError("injectedAuthenticationService has been called again, even though it's already initialized");return t._authenticationService=e,r()})},e.prototype.handle=function(e,t,r){return this._requestUtility.handle(e,t,r,this._authenticationService)},e.convertAngularPromise=function(e){return new Promise(function(t,r){e.then(function(e){return t(e)}).catch(function(e){return r(e)})})},e.handleAuthResult=function(e,t,r){var n=t.bootstrapServices.newScenario(rr.AuthHandlerRequest);return n.appendEventData({operation:r}),e.then(function(e){if(null==e){var t="response payload is empty";throw n.fail({message:t}),new Error(t)}var o={statusMsg:r+" request in main renderer has been processed",data:e};return n.stop(),o}).catch(function(e){var o="the request type for "+r+" failed due to "+e.message;throw sr.onHandlerError(t,p.UnhandledPromiseRejection,"the auth handler has exception",o,"CDLAuthHandler"),n.fail({message:o}),new Error(o)})},e.getAadTokensAngular=function(t,r,n){var o=t.context.resource;return r.bootstrapServices.logger.log("Auth handler started serving request "+tr.AadGetToken+" for resource "+o,i({component:"CDLAuthHandler"},r.loggingContext)),e.handleAuthResult(e.convertAngularPromise(n.getAuthTokens([o])),r,tr.AadGetToken)},e.getUserInformationAngular=function(t,r,n){return r.bootstrapServices.logger.log("Auth handler started serving request "+t.requestOperationtype,i({component:"CDLAuthHandler"},r.loggingContext)),e.handleAuthResult(e.convertAngularPromise(n.getUserInformation()),r,tr.AadGetCurrentUser)},e.getUserIsAnonymousAngular=function(t,r,n){return r.bootstrapServices.logger.log("Auth handler started serving request "+t.requestOperationtype,i({component:"CDLAuthHandler"},r.loggingContext)),e.handleAuthResult(Promise.resolve(n.isAnonymous()),r,tr.AadIsCurrentUserAnonymous)},e.getUserDetailsAngular=function(t,r,n){return r.bootstrapServices.logger.log("Auth handler started serving request "+t.requestOperationtype,i({component:"CDLAuthHandler"},r.loggingContext)),e.handleAuthResult(e.convertAngularPromise(n.getUserDetails()),r,tr.GetUserDetails)},e.getSkypeTokensAngular=function(t,r,n){return r.bootstrapServices.logger.log("Auth handler started serving request "+t.requestOperationtype,i({component:"CDLAuthHandler"},r.loggingContext)),e.handleAuthResult(n.getSkypeTokens(),r,tr.GetSkypeTokens)},e.getAadTokens=function(t,r,n){var o=t.context.resource;return r.bootstrapServices.logger.log("Auth handler started serving request "+tr.AadGetToken+" for resource "+o,i({component:"CDLAuthHandler"},r.loggingContext)),e.handleAuthResult(n.acquireToken(o),r,tr.AadGetToken)},e.getUserInformation=function(t,r,n){return r.bootstrapServices.logger.log("Auth handler started serving request "+t.requestOperationtype,i({component:"CDLAuthHandler"},r.loggingContext)),e.handleAuthResult(n.getUser(),r,tr.AadGetCurrentUser)},e}();!function(e){e.MachineActive="MachineActive",e.MachineInactive="MachineInactive",e.MachineLongInactive="MachineLongInactive",e.MachineLocked="MachineLocked"}(cr||(cr={})),function(e){e.NotifyAppState="NotifyAppState",e.NotifyServiceUp="NotifyServiceUp",e.NotifyServiceDown="NotifyServiceDown"}(ur||(ur={})),function(e){e[e.ChatSync=0]="ChatSync",e[e.Presence=1]="Presence",e[e.Files=2]="Files",e[e.OneNote=3]="OneNote",e[e.Groups=4]="Groups",e[e.Video=5]="Video",e[e.MasterTab=6]="MasterTab",e[e.IndexDb=7]="IndexDb",e[e.AdalTokens=8]="AdalTokens",e[e.AdalLogin=9]="AdalLogin",e[e.AdalReauth=10]="AdalReauth",e[e.SkypeTokens=11]="SkypeTokens",e[e.SkypeLicense=12]="SkypeLicense",e[e.SupportedBrowser=13]="SupportedBrowser",e[e.MSAGuestLicense=14]="MSAGuestLicense",e[e.AppSession=15]="AppSession"}(lr||(lr={}));var pr,_r,fr,hr=function(){function e(){this._requestUtility=new sr("CDLAppServiceHandler");var t=[{requestType:ur.NotifyServiceUp,handlerFunc:e.notifyServiceUp},{requestType:ur.NotifyServiceDown,handlerFunc:e.notifyServiceDown}];this._requestUtility.addHandlers(t)}return e.prototype.injectAppState=function(e){var t=this;return new Promise(function(r){if(t.appService)throw new TypeError("injectAppStateService has been called again, even though it's already initialized");return t.appService=e,r()})},e.prototype.handle=function(e,t,r){return this._requestUtility.handle(e,t,r,this.appService)},e.notifyServiceUp=function(e,t,r){return new Promise(function(n){t.bootstrapServices.logger.log("App service change is received, "+e.context.appService+" is up and running",i({component:"CDLAppStateHandler"},t.loggingContext));var o=e.context,a=o.appService,s=o.reason;return r.notifyServiceUp(a,s),n()})},e.notifyServiceDown=function(e,t,r){return new Promise(function(n){t.bootstrapServices.logger.log("App service change is received, "+e.context.appService+" is down",i({component:"CDLAppStateHandler"},t.loggingContext));var o=e.context,a=o.appService,s=o.reason,c=o.code;return r.notifyServiceDown(a,s,c),n()})},e}(),gr=function(e,t,r){var n=new hr,o={action:n.injectAppState.bind(n)},i=new Map;return i.set("appService:Injected",o),{appServiceMessageHandler:n,appServiceStateMachine:new ar(r,i,"appService:Loaded",{bootstrapServices:e,loggingContext:{hostRendererId:t,requestType:"appService"}})}};function vr(e,t,r){var n=new dr(t),o={action:n.injectNgAuthenticationService.bind(n)},i=new Map;i.set("authServiceInjected",o);var a=new ir(r,i,"authLoaded",{bootstrapServices:e,loggingContext:{hostRendererId:t,requestType:"auth"}}),s=gr(e,t,r),c=s.appServiceStateMachine,u=s.appServiceMessageHandler;return new Map([[y.auth,{stateMachine:a,requestHandler:n}],[y.appService,{stateMachine:c,requestHandler:u}]])}function mr(e,t,n,o,i){var a,s=((a=new Map).set(y.control,$t),a.set(y.database,$t),a.set(y.workerHostSettings,$t),a.set(y.diagnostics,$t),a.set(y.appState,Zt),a.set(y.graphql,er),a.set(y.syncEngine,$t),a);return n?function(e,t,n,o,i){if(o){var a=new SharedWorker(o);return Promise.resolve(br(e,t,n,function(e){return a.port.postMessage(e)},function(e){a.port.onmessage=function(t){return e(t,function(e){return a.port.postMessage(e)})}}))}return Promise.resolve().then(r.bind(null,"0fd718ff208f632558c0")).then(function(r){var o=new r.CDLSharedWorker;return br(e,t,n,function(e){return o.port.postMessage(e)},function(e){o.port.onmessage=function(t){return e(t,function(e){return o.port.postMessage(e)})}})})}(e,t,s,o&&o.cdlSharedWorkerUrl):function(e,t,n,o,i){if(o){var a=new Worker(o);return Promise.resolve(br(e,t,n,function(e){return a.postMessage(e)},function(e){a.onmessage=function(t){return e(t,function(e){return a.postMessage(e)})}}))}return Promise.resolve().then(r.bind(null,"37514bca4dcc2a38a3c0")).then(function(r){var o=new r.CDLWebWorker;return br(e,t,n,function(e){return o.postMessage(e)},function(e){o.onmessage=function(t){return e(t,function(e){return o.postMessage(e)})}})})}(e,t,s,o&&o.cdlWebWorkerUrl)}function br(e,t,r,n,o){var i=new w({bootstrapServices:e,loggingContext:{hostRendererId:t}});i.setState("bootstrapped");var a=Vt(e,{postMessageCallback:function(e){return n(e)},clients:r},{globalState:i,requestAndStateHandlers:vr(e,t,i)},t);return a.workerServer.start(),o(function(e,t){return a.onMessageCallback(e,t)}),{workerServer:a.workerServer,workerClientResponseRouter:a.workerClientResponseRouter,state:i}}function yr(e){return new Promise(function(t,r){e<0?r(new Error("negative timeout")):setTimeout(t,e)})}!function(e){e[e.SECONDS_PER_MINUTE=60]="SECONDS_PER_MINUTE",e[e.MILLI_PER_SECOND=1e3]="MILLI_PER_SECOND",e[e.MILLI_PER_MINUTE=6e4]="MILLI_PER_MINUTE"}(pr||(pr={})),function(e){e[e.LOAD_FRAME_TIMEOUT=15e3]="LOAD_FRAME_TIMEOUT",e[e.EXPIRE_OFFSET_SECONDS=600]="EXPIRE_OFFSET_SECONDS",e[e.MT_TOKEN_INTERVAL=12e4]="MT_TOKEN_INTERVAL",e[e.ACQUIRE_TOKEN_TIMEOUT=6e4]="ACQUIRE_TOKEN_TIMEOUT",e[e.ELECTRON_ACQUIRE_TOKEN_TIMEOUT=18e4]="ELECTRON_ACQUIRE_TOKEN_TIMEOUT",e[e.ACQUIRE_TOKEN_SCENARIO_TIMEOUT=19e4]="ACQUIRE_TOKEN_SCENARIO_TIMEOUT"}(_r||(_r={})),function(e){e.SKYPE_KEY="skype",e.MT_KEY="middleTier",e.MT_AAD_KEY="https://api.spaces.skype.com"}(fr||(fr={}));var Sr,wr=10*pr.MILLI_PER_SECOND,kr=function(e,t,r,n,o,i){return a(void 0,void 0,void 0,function(){var i,a,c,u,l;return s(this,function(s){switch(s.label){case 0:i=r.newScenario(rr.CentralDataLayerWorkerManagerStartup),s.label=1;case 1:return s.trys.push([1,4,,5]),[4,mr(r,e,"electron"===t,n)];case 2:return(a=s.sent()).state.setState("loaded"),i.mark(nr.CdlWorkerManagerLoaded),o=o||wr,[4,(d=a.workerClientResponseRouter.cdlControlClient.sendRequest("health_check"),f=o,Promise.race([d,yr(f).then(function(){throw Bt(_.Timed,p.TimedOut,_.Timed,{ms:f},h)})]))];case 3:return s.sent(),a.state.setState("health_checked"),i.mark(nr.CdlWorkerManagerHealthChecked),a.state.setState("initialized"),i.stop(),[2,a];case 4:throw c=s.sent(),u="Failed to initialize the worker "+Gt(c),r.logger.error(u,{hostRendererId:e,component:"CDLWorkerManager"},p.Unknown),l={errors:u},c&&c.code===p.TimedOut?i.stop(l,"timeout"):i.fail(l),c;case 5:return[2]}var d,f,h})})};!function(e){e.MainRenderer="main-renderer",e.Embed="embed",e.HybridExperience="hybrid-experience"}(Sr||(Sr={}));var Cr={error:function(e,t,r){var n=JSON.stringify(t)+":"+JSON.stringify(r)+":"+JSON.stringify(e);console.error(new Date(Date.now()).toISOString()+":"+n),window.cdlLoggerBuffer.push({level:"error",msg:n})},warn:function(e,t){var r=JSON.stringify(t)+":"+JSON.stringify(e);console.warn(new Date(Date.now()).toISOString()+":"+r),window.cdlLoggerBuffer.push({level:"warn",msg:r})},log:function(e,t){var r=JSON.stringify(t)+":"+JSON.stringify(e);console.log(new Date(Date.now()).toISOString()+":"+r),window.cdlLoggerBuffer.push({level:"log",msg:r})},debug:function(e,t){var r=JSON.stringify(t)+":"+JSON.stringify(e);console.info(new Date(Date.now()).toISOString()+":"+r),window.cdlLoggerBuffer.push({level:"debug",msg:r})}},Tr=0,Ar=function(e){Tr++,performance.mark(e+":start");var t=performance.now(),r=[t],n={id:Tr.toString(),name:e,delta:0,timestamp:t,timeoutMs:0,isPaused:!1,eventData:{},marks:[],status:void 0,appendEventData:function(e){Object.assign(this.eventData,e)},pause:function(){throw new Error("Not implemented")},resume:function(){throw new Error("Not implemented")},cancel:function(){this.stop(void 0,"cancelled")},mark:function(t){performance.mark(e+":"+t),this.marks.push(t),this.timestamps.push(performance.now())},startStep:function(){},stop:function(t,r){r||(r="success"),this.mark("stop"),performance.measure(e,e+":start",e+":stop"),this.appendEventData({data:t,status:r}),this.delta=Math.floor(this.timestamps[this.timestamps.length-1]-this.timestamps[0]),this.status=r},fail:function(e){this.stop(e,"failed")},incomplete:function(e){this.stop(e,"incomplete")},timestamps:r,markAggregateStart:function(){throw new Error("Not implemented")},markAggregateStop:function(){throw new Error("Not implemented")},getTotalPauseDuration:function(){throw new Error("Not implemented")}};return window.cdlScenarioBuffer.push(n),n};function Er(){if(window.isCDLWorkerAvailable||-1!==window.location.search.indexOf("enableCDLWorkerForTests")){var e={logger:Cr,newScenario:function(e){return Ar(e)},hostRendererId:Xt};window.cdlLoggerBuffer=[],window.cdlScenarioBuffer=[],window.cdlBootstrapServices=e,performance.mark("CDLWorkerManagerLoad:start"),window.cdlWorkerManagerLoadPromise=kr(Xt,window.desktop?"electron":"web",e,{cdlSharedWorkerUrl:window.cdlSharedWorkerJsUrl,cdlWebWorkerUrl:window.cdlWebWorkerJsUrl},1e5,Sr.MainRenderer).then(function(e){return window.cdlWorkerManager=e,performance.mark("CDLWorkerManagerLoad:stop"),performance.measure("CDLWorkerManagerLoad","CDLWorkerManagerLoad:start","CDLWorkerManagerLoad:stop"),e})}}r.d(t,"initializeWorker",function(){return Er}),Er()},"698d75b157f24ae829cc":function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},"91537a72d48de18b3c5a":function(e,t,r){e.exports=function(){return new Worker(r.p+"precompiled-web-worker-c740330cd5f3f89e.js")}},"9edef3da34909980d480":function(e,t,r){e.exports=r("004e3511e392df2e6d63").Observable},b8c08b527e4f22d848fd:function(e,t,r){"use strict";(function(e){var n=r("0bd0afb5c74547a322b4"),o=r("f5d812633866a6a25035"),i="object"==typeof exports&&exports&&!exports.nodeType&&exports,a=i&&"object"==typeof e&&e&&!e.nodeType&&e,s=a&&a.exports===i?n.a.Buffer:void 0,c=(s?s.isBuffer:void 0)||o.a;t.a=c}).call(this,r("044f282f6141fc605782")(e))},c7e58922b074f46ef336:function(e,t,r){e.exports=function(e){return new SharedWorker(r.p+"precompiled-shared-worker-266d9f946c3b42db.js",e)}},dbf5d091004dd78b9cad:function(e,t,r){"use strict";(function(e){var n=r("03f2c9f483943a5aa073"),o="object"==typeof exports&&exports&&!exports.nodeType&&exports,i=o&&"object"==typeof e&&e&&!e.nodeType&&e,a=i&&i.exports===o&&n.a.process,s=function(){try{var e=i&&i.require&&i.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(e){}}();t.a=s}).call(this,r("044f282f6141fc605782")(e))},f5d812633866a6a25035:function(e,t,r){"use strict";t.a=function(){return!1}}})