<!DOCTYPE html>
<!-- saved from url=(0030)https://teams.microsoft.com/go -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Checking your credentials...</title><meta name="viewport"><meta name="robots" content="noindex"><script nonce="">function sendAppStateChanged(e){window.electronSafeIpc&&window.electronSafeIpc.send("appStateChanged",e)}sendAppStateChanged("AuthstrapInitialize");</script><script nonce="">sendAppStateChanged("AuthstrapAdalScriptLoading");var AuthenticationContext,Logging={level:0,log:function(){}};"undefined"!=typeof module&&module.exports&&(module.exports.inject=function(t){return new AuthenticationContext(t)}),(AuthenticationContext=function(t){if(this.REQUEST_TYPE={LOGIN:"LOGIN",RENEW_TOKEN:"RENEW_TOKEN",UNKNOWN:"UNKNOWN"},this.CONSTANTS={ACCESS_TOKEN:"access_token",EXPIRES_IN:"expires_in",ID_TOKEN:"id_token",ERROR_DESCRIPTION:"error_description",SESSION_STATE:"session_state",STORAGE:{TOKEN_KEYS:"adal.token.keys",ACCESS_TOKEN_KEY:"adal.access.token.key",EXPIRATION_KEY:"adal.expiration.key",START_PAGE:"adal.start.page",START_PAGE_PARAMS:"adal.start.page.params",STATE_LOGIN:"adal.state.login",STATE_RENEW:"adal.state.renew",STATE_RENEW_RESOURCE:"adal.state.renew.resource",NONCE_IDTOKEN:"adal.nonce.idtoken",SESSION_STATE:"adal.session.state",USERNAME:"adal.username",IDTOKEN:"adal.idtoken",ERROR:"adal.error",ERROR_DESCRIPTION:"adal.error.description",LOGIN_REQUEST:"adal.login.request",LOGIN_ERROR:"adal.login.error"},RESOURCE_DELIMETER:"|",ERR_MESSAGES:{NO_TOKEN:"User is not authorized"},LOADFRAME_TIMEOUT:"15000",LOADFRAME_PENDING:"pending",LOADFRAME_TIMEOUT_CODE:"AADSTSTimeout",LOGGING_LEVEL:{ERROR:0,WARN:1,INFO:2,VERBOSE:3},LEVEL_STRING_MAP:{0:"ERROR:",1:"WARNING:",2:"INFO:",3:"VERBOSE:"},POPUP_WIDTH:483,POPUP_HEIGHT:600},AuthenticationContext.prototype._singletonInstance)return AuthenticationContext.prototype._singletonInstance;if((AuthenticationContext.prototype._singletonInstance=this).instance="https://login.microsoftonline.com/",this.config={},this.callback=null,this.popUp=!1,this._user=null,this._activeRenewals={},this._loginInProgress=!1,this._acquireTokenInProgress=!1,this._renewStates=[],this._openedWindows=[],window.loadframeStatus={},window.callBackMappedToRenewStates={},window.callBacksMappedToRenewStates={},t.displayCall&&"function"!=typeof t.displayCall)throw new Error("displayCall is not a function");if(!t.clientId)throw new Error("clientId is required");t.correlationId||(t.correlationId=this._guid()),this.config=this._cloneConfig(t),this.config.loginResource||(this.config.loginResource=this.config.clientId),this.config.redirectUri||(this.config.redirectUri=window.location.href)}).prototype.login=function(t){t=t||"";var e=this._guid();this.config.state=e,this._idTokenNonce=this._guid(),this.verbose("Expected state: "+e+" startPage:"+window.location),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,window.location),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,e),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var i=this._getNavigateUrl("id_token",null)+"&nonce="+encodeURIComponent(this._idTokenNonce);i=this._getUrlWithGlobalResource(i,this.config.globalResource),this._user&&this._user.profile?this._isMsaUser(this._user.profile)||(this._isGuestUser(this._user.profile)||(i+="&login_hint="+encodeURIComponent(this._user.userName)),this._urlContainsQueryStringParameter("domain_hint",i)||(i+="&domain_hint="+encodeURIComponent(this._getDomainHint()))):this._urlContainsQueryStringParameter("domain_hint",i)||(i+="&domain_hint="+encodeURIComponent(this._getDomainHint())),this.frameCallInProgress=!1,this._loginInProgress=!0,window.electronSafeIpc&&window.electronSafeIpc.send("telemetryEvent",{name:"desktop_adal_login",resource:this.config.clientId,reason:t}),this.event("adal_login",{resource:this.config.clientId,reason:t}),this.config.displayCall?this.config.displayCall(i):this.promptUser(i)},AuthenticationContext.prototype._getUrlWithGlobalResource=function(t,e){return e?t.replace("=id_token","=token id_token")+"&resource="+e:t},AuthenticationContext.prototype.loginInProgress=function(){return this._loginInProgress},AuthenticationContext.prototype._hasResource=function(t){var e=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);return e&&!this._isEmpty(e)&&-1<e.indexOf(t+this.CONSTANTS.RESOURCE_DELIMETER)},AuthenticationContext.prototype.getCachedToken=function(t){if(!this._hasResource(t))return null;var e=this._getItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t),i=this._getItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t),n=this.config.expireOffsetSeconds||120;if(i&&i>this._now()+n)return e;if(i&&i>0){var o=i-this._now();this.info("Token cleared from local storage for resource:"+t+" expires in:"+o),this.event("adalCacheCleared",{resource:t,expiresIn:o})}return this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t,0),null},AuthenticationContext.prototype.getCachedUser=function(){if(this._user)return this._user;var t=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);return this._user=this._createUser(t),this._user},AuthenticationContext.prototype.registerCallback=function(t,e,i){this._activeRenewals[e]=t,window.callBacksMappedToRenewStates[t]||(window.callBacksMappedToRenewStates[t]=[]);var n=this;window.callBacksMappedToRenewStates[t].push(i),window.callBackMappedToRenewStates[t]||(window.callBackMappedToRenewStates[t]=function(i,o){for(var s=0;s<window.callBacksMappedToRenewStates[t].length;++s)window.callBacksMappedToRenewStates[t][s](i,o);n._activeRenewals[e]=null,window.callBacksMappedToRenewStates[t]=null,window.callBackMappedToRenewStates[t]=null})},AuthenticationContext.prototype._renewToken=function(t,e){this.info("renewToken is called for resource:"+t);var i=this._addAdalFrame("adalRenewFrame"+t),n=this._guid()+"|"+t;this._idTokenNonce=this._guid(),this.config.state=n,this._renewStates.push(n),this.verbose("Renew token Expected state: "+n);var o=this._getNavigateUrl("token",t)+"&prompt=none";this._isMsaUser(this._user.profile)||(this._isGuestUser(this._user.profile)||(o+="&login_hint="+encodeURIComponent(this._user.userName)),this._urlContainsQueryStringParameter("domain_hint",o)||(o+="&domain_hint="+encodeURIComponent(this._getDomainHint()))),o+="&nonce="+encodeURIComponent(this._idTokenNonce),this.callback=e,this.registerCallback(n,t,e),this.idTokenNonce=null,this.verbose("Navigate to:"+o),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,""),i.src="about:blank",this._loadFrameTimeout(o,"adalRenewFrame"+t,t,this.CONSTANTS.LOADFRAME_TIMEOUT)},AuthenticationContext.prototype._renewIdToken=function(t){this.info("renewIdToken is called");var e=this._addAdalFrame("adalIdTokenFrame"),i=this._guid()+"|"+this.config.clientId;this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce),this.config.state=i,this._renewStates.push(i),this.verbose("Renew Idtoken Expected state: "+i);var n=this._getNavigateUrl("id_token",null)+"&prompt=none";this._isMsaUser(this._user.profile)||(this._isGuestUser(this._user.profile)||(n+="&login_hint="+encodeURIComponent(this._user.userName)),this._urlContainsQueryStringParameter("domain_hint",n)||(n+="&domain_hint="+encodeURIComponent(this._getDomainHint()))),n+="&nonce="+encodeURIComponent(this._idTokenNonce),this.registerCallback(i,this.config.clientId,t),this.idTokenNonce=null,this.verbose("Navigate to:"+n),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,""),e.src="about:blank",this._loadFrameTimeout(n,"adalIdTokenFrame",this.config.clientId,this.CONSTANTS.LOADFRAME_TIMEOUT)},AuthenticationContext.prototype._urlContainsQueryStringParameter=function(t,e){return new RegExp("[\\?&]"+t+"=").test(e)},AuthenticationContext.prototype._loadFrameTimeout=function(t,e,i,n){this.info("Set loading state to pending for: "+i),window.loadframeStatus[i]=this.CONSTANTS.LOADFRAME_PENDING,this.event("adalIframePending",{resource:i}),this._loadFrame(t,e);var o=n/1e3,s=i,r=this;setTimeout(function(){if(window.loadframeStatus[i]===r.CONSTANTS.LOADFRAME_PENDING){r.error("Loading frame has timed out after: "+o+" seconds for resource "+s);var t=r._activeRenewals[i];t&&window.callBackMappedToRenewStates[t]&&window.callBackMappedToRenewStates[t](r.CONSTANTS.LOADFRAME_TIMEOUT_CODE+" due to timeout",null),r.error("Removing iframe session tracking for resource:"+i),r.event("adalIframeCleared",{resource:i,reason:"timeout"}),delete window.parent.loadframeStatus[i]}},n)},AuthenticationContext.prototype._loadFrame=function(t,e){var i=this;i.info("LoadFrame: "+e);var n=e;setTimeout(function(){var e=i._addAdalFrame(n);""!==e.src&&"about:blank"!==e.src||(e.src=t,i._loadFrame(t,n))},500)},AuthenticationContext.prototype.acquireToken=function(t,e){if(this._isEmpty(t))return this.warn("resource is required"),void e("resource is required",null);var i=this.getCachedToken(t);return i?(this.info("Token is already in cache for resource:"+t),void e(null,i)):this._user?void(this._activeRenewals[t]?this.registerCallback(this._activeRenewals[t],t,e):(this.event("adalAcquireToken",{resource:t}),t===this.config.clientId?(this.info("renewing idtoken"),this._renewIdToken(e)):(this.info("renewing token "+t),this._renewToken(t,e)))):(this.warn("User login is required"),void e("User login is required",null))},AuthenticationContext.prototype.acquireTokenRedirect=function(t,e,i){if(this._isEmpty(t))return this.warn("resource is required"),void n("resource is required",null,"resource is required");var n=this.callback;if(!this._user)return this.warn("User login is required"),void n("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void n("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var o=this._guid()+"|"+t;this.config.state=o,this.verbose("Renew token Expected state: "+o);var s=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",t),"prompt");if(s+="&prompt=select_account",e&&(s+=e),i&&-1===s.indexOf("&claims"))s+="&claims="+encodeURIComponent(i);else if(i&&-1!==s.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");s=this._addHintParameters(s),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,window.location.href),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,o,!0),this.promptUser(s)},AuthenticationContext.prototype.acquireTokenPopup=function(t,e,i,n){if(this._isEmpty(t))return this.warn("resource is required"),void n("resource is required",null,"resource is required");if(!this._user)return this.warn("User login is required"),void n("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void n("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var o=this._guid()+"|"+t;this.config.state=o,this._renewStates.push(o),this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,this.verbose("Renew token Expected state: "+o);var s=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",t),"prompt");if(s+="&prompt=select_account",e&&(s+=e),i&&-1===s.indexOf("&claims"))s+="&claims="+encodeURIComponent(i);else if(i&&-1!==s.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");s=this._addHintParameters(s),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+t),this.registerCallback(o,t,n),this._loginPopup(s,t,n)},AuthenticationContext.prototype._loginPopup=function(t,e,i){var n=this._openPopup(t,"login",this.CONSTANTS.POPUP_WIDTH,this.CONSTANTS.POPUP_HEIGHT),o=i||this.callback;if(null!=n){if(this._openedWindows.push(n),-1!=this.config.redirectUri.indexOf("#"))var s=this.config.redirectUri.split("#")[0];else s=this.config.redirectUri;var r=this,a=window.setInterval(function(){if(!n||n.closed||void 0===n.closed){var t="Popup Window closed by UI action/ Popup Window handle destroyed due to cross zone navigation in IE/Edge";return r._handlePopupError(o,e,"Popup Window closed",t,t),void window.clearInterval(a)}try{var i=n.location;if(-1!=encodeURI(i.href).indexOf(encodeURI(s)))return r.handleWindowCallback(i.hash),window.clearInterval(a),r._loginInProgress=!1,r._acquireTokenInProgress=!1,r.info("Closing popup window"),r._openedWindows=[],void n.close()}catch(t){}},1)}else{var h="Popup Window is null. This can happen if you are using IE";this._handlePopupError(o,e,"Error opening popup",h,h)}},AuthenticationContext.prototype._openPopup=function(t,e,i,n){try{var o=window.screenLeft?window.screenLeft:window.screenX,s=window.screenTop?window.screenTop:window.screenY,r=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,h=r/2-i/2+o,c=a/2-n/2+s,u=window.open(t,e,"width="+i+", height="+n+", top="+c+", left="+h);return u.focus&&u.focus(),u}catch(t){return this.warn("Error opening popup, "+t.message),this._loginInProgress=!1,this._acquireTokenInProgress=!1,null}},AuthenticationContext.prototype._handlePopupError=function(t,e,i,n,o){this.warn(n),this._saveItem(this.CONSTANTS.STORAGE.ERROR,i),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,n),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,o),e&&this._activeRenewals[e]&&(this._activeRenewals[e]=null),this._loginInProgress=!1,this._acquireTokenInProgress=!1,t&&t(n,null,i)},AuthenticationContext.prototype._urlRemoveQueryStringParameter=function(t,e){var i=new RegExp("(\\&"+e+"=)[^&]+");return t=t.replace(i,""),i=new RegExp("("+e+"=)[^&]+&"),t=t.replace(i,""),i=new RegExp("("+e+"=)[^&]+"),t=t.replace(i,"")},AuthenticationContext.prototype._addHintParameters=function(t){if(this._user&&this._user.profile)if(this._user.profile.sid&&-1!==t.indexOf("&prompt=none"))this._urlContainsQueryStringParameter("sid",t)||(t+="&sid="+encodeURIComponent(this._user.profile.sid));else if(this._user.profile.upn&&(this._urlContainsQueryStringParameter("login_hint",t)||(t+="&login_hint="+encodeURIComponent(this._user.profile.upn)),!this._urlContainsQueryStringParameter("domain_hint",t)&&-1<this._user.profile.upn.indexOf("@"))){var e=this._user.profile.upn.split("@");t+="&domain_hint="+encodeURIComponent(e[e.length-1])}return t},AuthenticationContext.prototype.promptUser=function(t){t?(this.info("Navigate to:"+t),window.location.replace(t)):this.error("Navigate url is empty")},AuthenticationContext.prototype.clearCache=function(){this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY,0),this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._renewStates=[],this._saveItem(this.CONSTANTS.STORAGE.START_PAGE,""),this._saveItem(this.CONSTANTS.STORAGE.START_PAGE_PARAMS,""),this._saveItem(this.CONSTANTS.STORAGE.USERNAME,""),this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);if(!this._isEmpty(t)){t=t.split(this.CONSTANTS.RESOURCE_DELIMETER);for(var e=0;e<t.length;e++)this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t[e],""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t[e],0)}this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,"")},AuthenticationContext.prototype.clearCacheForResource=function(t){this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._hasResource(t)&&(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t,0))},AuthenticationContext.prototype.logOut=function(){this.clearCache();var t="common",e="";this._user=null,this.config.tenant&&(t=this.config.tenant),this.config.instance&&(this.instance=this.config.instance),this.config.postLogoutRedirectUri&&(e="post_logout_redirect_uri="+encodeURIComponent(this.config.postLogoutRedirectUri));var i=this.instance+t+"/oauth2/logout?"+e;this.info("Logout navigate to: "+i),this.promptUser(i)},AuthenticationContext.prototype._isEmpty=function(t){return void 0===t||!t||0===t.length},AuthenticationContext.prototype.getUser=function(t){if("function"!=typeof t)throw new Error("callback is not a function");if(this.callback=t,this._user)this.callback(null,this._user);else{var e=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);this._isEmpty(e)?(this.warn("User information is not available"),this.callback("User information is not available")):(this.info("User exists in cache: "),this._user=this._createUser(e),this.callback(null,this._user))}},AuthenticationContext.prototype._isGuestUser=function(t){return t&&t.hasOwnProperty("idp")&&t.hasOwnProperty("iss")&&t.iss!==t.idp},AuthenticationContext.prototype._isMsaUser=function(t){return t&&t.hasOwnProperty("altsecid")&&0===t.altsecid.indexOf("1:")},AuthenticationContext.prototype._getDomainHint=function(){if(this._user&&this._user.userName&&-1<this._user.userName.indexOf("@")){var t=this._user.userName.split("@");return t[t.length-1]}return""},AuthenticationContext.prototype._createUser=function(t){var e=null,i=this._extractIdToken(t);return i&&i.hasOwnProperty("aud")&&(i.aud.toLowerCase()===this.config.clientId.toLowerCase()?(e={userName:"",profile:i},i.hasOwnProperty("upn")&&!this._isGuestUser(i)?e.userName=i.upn:i.hasOwnProperty("email")&&(e.userName=i.email),i.hasOwnProperty("tid")&&(this.config.tenant=i.tid)):this.warn("IdToken has invalid aud field")),e},AuthenticationContext.prototype._getHash=function(t){return-1<t.indexOf("#/")?t=t.substring(t.indexOf("#/")+2):-1<t.indexOf("#")&&(t=t.substring(1)),t},AuthenticationContext.prototype.isCallback=function(t){t=this._getHash(t);var e=this._deserialize(t);return e.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||e.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||e.hasOwnProperty(this.CONSTANTS.ID_TOKEN)},AuthenticationContext.prototype.getLoginError=function(){return this._getItem(this.CONSTANTS.STORAGE.LOGIN_ERROR)},AuthenticationContext.prototype.getRequestInfo=function(t){t=this._getHash(t);var e=this._deserialize(t),i={valid:!1,parameters:{},stateMatch:!1,stateResponse:"",requestType:this.REQUEST_TYPE.UNKNOWN};if(e&&((i.parameters=e).hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||e.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||e.hasOwnProperty(this.CONSTANTS.ID_TOKEN))){i.valid=!0;var n="";if(!e.hasOwnProperty("state"))return this.warn("No state returned"),i;if(this.verbose("State: "+e.state),n=e.state,(i.stateResponse=n)===this._getItem(this.CONSTANTS.STORAGE.STATE_LOGIN))return i.requestType=this.REQUEST_TYPE.LOGIN,i.stateMatch=!0,i;if(!i.stateMatch&&window.parent&&window.parent.AuthenticationContext())for(var o=window.parent.AuthenticationContext()._renewStates,s=0;s<o.length;s++)if(o[s]===i.stateResponse){i.requestType=this.REQUEST_TYPE.RENEW_TOKEN,i.stateMatch=!0;break}}return i},AuthenticationContext.prototype._getResourceFromState=function(t){if(t){var e=t.indexOf("|");if(e>-1&&e+1<t.length)return t.substring(e+1)}return""},AuthenticationContext.prototype._getCookie=function(t){var e=("; "+document.cookie).split("; "+t+"=");return 2==e.length?e.pop().split(";").shift():void 0},AuthenticationContext.prototype.saveTokenFromHash=function(t){var e=this._getResourceFromState(t.stateResponse);if(this.event("adalIframeResponded",{resource:e,arrAffinity:this._getCookie("ARRAffinity")}),this.info("State status:"+t.stateMatch+"; Request type:"+t.requestType),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),t.parameters.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION))this.error("Error :"+t.parameters.error+"; Error description:"+t.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),this._saveItem(this.CONSTANTS.STORAGE.ERROR,t.parameters.error),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,t.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),t.requestType===this.REQUEST_TYPE.LOGIN&&(this._loginInProgress=!1,this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,t.parameters.errorDescription));else if(t.stateMatch){var i;if(this.info("State is right"),t.parameters.hasOwnProperty(this.CONSTANTS.SESSION_STATE)&&this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,t.parameters[this.CONSTANTS.SESSION_STATE]),t.parameters.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)){this.info("Fragment has access token"),this._hasResource(e)||(i=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,i+e+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e,t.parameters[this.CONSTANTS.ACCESS_TOKEN]);var n=this._expiresIn(t.parameters[this.CONSTANTS.EXPIRES_IN]),o=n-this._now();this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e,n),this.info("Access token successfully updated in local storage for resource:"+e+" expires in:"+o+" seconds"),this.event("adalAccessTokenUpdate",{resource:e,expiresIn:o})}if(t.parameters.hasOwnProperty(this.CONSTANTS.ID_TOKEN)&&(this.info("Fragment has id token"),this._loginInProgress=!1,this._user=this._createUser(t.parameters[this.CONSTANTS.ID_TOKEN]),this._user&&this._user.profile)){var s=this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN);if(this._user.profile.nonce!==s){var r="Nonce in profile is not the same as whats in storage. profile.nonce:"+this._user.profile.nonce+", stored nonce:"+s;this._user=null,this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,r)}else{this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,t.parameters[this.CONSTANTS.ID_TOKEN]),e=this.config.loginResource?this.config.loginResource:this.config.clientId,this._hasResource(e)||(i=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,i+e+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e,t.parameters[this.CONSTANTS.ID_TOKEN]);var a=this._user.profile.exp||0,h=a-this._now();this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e,a),this.info("ID token successfully updated in local storage for resource:"+e+" expires in:"+h+" seconds"),this.event("adalIdTokenUpdate",{resource:e,expiresIn:h})}}}else this._saveItem(this.CONSTANTS.STORAGE.ERROR,"Invalid_state"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid_state. state: "+t.stateResponse);window.parent&&window.parent.loadframeStatus&&e&&(this.info("Removing iframe session tracking for resource:"+e),this.event("adalIframeCleared",{resource:e,reason:"saved token from hash"}),delete window.parent.loadframeStatus[e])},AuthenticationContext.prototype.getResourceForEndpoint=function(t){if(this.config&&this.config.endpoints)for(var e in this.config.endpoints)if(-1<t.indexOf(e))return this.config.endpoints[e];return-1<t.indexOf("http://")||-1<t.indexOf("https://")?this._getHostFromUri(t)===this._getHostFromUri(this.config.redirectUri)?this.config.loginResource:null:this.config.loginResource},AuthenticationContext.prototype._getHostFromUri=function(t){var e=String(t).replace(/^(https?:)\/\//,"");return e=e.split("/")[0]},AuthenticationContext.prototype.handleWindowCallback=function(t){if(null==t&&(t=window.location.hash),this.isCallback(t)){var e=this.getRequestInfo(t);this.info("Returned from redirect url"),this.saveTokenFromHash(e);var i=null;if(e.requestType===this.REQUEST_TYPE.RENEW_TOKEN&&window.parent?(this.info("Window is in iframe"),i=window.parent.callBackMappedToRenewStates[e.stateResponse],this.verbose("iframe came back, deleting iframe session tracking for "+e.stateResponse),window.src=""):window&&window.oauth2Callback&&(this.verbose("Window is redirecting"),i=this.callback),window.location.hash="",window.location=this._getItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST),i&&e.requestType===this.REQUEST_TYPE.RENEW_TOKEN)return this.info("Executing window callback"),void i(this._getItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION),e.parameters[this.CONSTANTS.ACCESS_TOKEN]||e.parameters[this.CONSTANTS.ID_TOKEN])}},AuthenticationContext.prototype._getNavigateUrl=function(t,e){var i="common";this.config.tenant&&(i=this.config.tenant),this.config.instance&&(this.instance=this.config.instance);var n=this.instance+i+"/oauth2/authorize"+this._serialize(t,this.config,e)+this._addLibMetadata();return this.info("Navigate url:"+n),n},AuthenticationContext.prototype._extractIdToken=function(t){var e=this._decodeJwt(t);if(!e)return null;try{var i=e.JWSPayload,n=this._base64DecodeStringUrlSafe(i);return n?JSON.parse(n):(this.info("The returned id_token could not be base64 url safe decoded."),null)}catch(t){this.error("The returned id_token could not be decoded",t)}return null},AuthenticationContext.prototype._extractUserName=function(t){try{var e=this._extractIdToken(t);if(e){if(e.hasOwnProperty("upn"))return e.upn;if(e.hasOwnProperty("email"))return e.email}}catch(t){this.error("The returned id_token could not be decoded",t)}return null},AuthenticationContext.prototype._base64DecodeStringUrlSafe=function(t){return t=t.replace(/-/g,"+").replace(/_/g,"/"),window.atob?decodeURIComponent(escape(window.atob(t))):decodeURIComponent(escape(this._decode(t)))},AuthenticationContext.prototype._decode=function(t){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i=(t=String(t).replace(/=+$/,"")).length;if(i%4==1)throw new Error("The token to be decoded is not correctly encoded.");for(var n,o,s,r,a,h,c,u,l="",d=0;i>d;d+=4){if(n=e.indexOf(t.charAt(d)),o=e.indexOf(t.charAt(d+1)),s=e.indexOf(t.charAt(d+2)),r=e.indexOf(t.charAt(d+3)),d+2===i-1){h=(a=n<<18|o<<12|s<<6)>>16&255,c=a>>8&255,l+=String.fromCharCode(h,c);break}if(d+1===i-1){h=(a=n<<18|o<<12)>>16&255,l+=String.fromCharCode(h);break}h=(a=n<<18|o<<12|s<<6|r)>>16&255,c=a>>8&255,u=255&a,l+=String.fromCharCode(h,c,u)}return l},AuthenticationContext.prototype._decodeJwt=function(t){if(this._isEmpty(t))return null;var e=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);return!e||e.length<4?(this.warn("The returned id_token is not parseable."),null):{header:e[1],JWSPayload:e[2],JWSSig:e[3]}},AuthenticationContext.prototype._convertUrlSafeToRegularBase64EncodedString=function(t){return t.replace("-","+").replace("_","/")},AuthenticationContext.prototype._serialize=function(t,e,i){var n=[];return null!==e&&(n.push("?response_type="+t),n.push("client_id="+encodeURIComponent(e.clientId)),i&&n.push("resource="+encodeURIComponent(i)),n.push("redirect_uri="+encodeURIComponent(e.redirectUri)),n.push("state="+encodeURIComponent(e.state)),e.hasOwnProperty("slice")&&n.push("slice="+encodeURIComponent(e.slice)),e.hasOwnProperty("extraQueryParameter")&&n.push(e.extraQueryParameter),e.correlationId&&n.push("client-request-id="+encodeURIComponent(e.correlationId))),n.join("&")},AuthenticationContext.prototype._deserialize=function(t){var e,i=/\+/g,n=/([^&=]+)=?([^&]*)/g,o=function(t){return decodeURIComponent(t.replace(i," "))},s={};for(e=n.exec(t);e;)s[o(e[1])]=o(e[2]),e=n.exec(t);return s},AuthenticationContext.prototype._guid=function(){for(var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",e="0123456789abcdef",i=0,n="",o=0;36>o;o++)"-"!==t[o]&&"4"!==t[o]&&(i=16*Math.random()|0),"x"===t[o]?n+=e[i]:"y"===t[o]?(i&=3,n+=e[i|=8]):n+=t[o];return n},AuthenticationContext.prototype._expiresIn=function(t){return this._now()+parseInt(t,10)},AuthenticationContext.prototype._now=function(){return Math.round((new Date).getTime()/1e3)},AuthenticationContext.prototype._addAdalFrame=function(t){if(void 0!==t){var e=document.getElementById(t);if(!e){if(this.info("Attempting to add adal frame to document:"+t),document.createElement&&document.documentElement&&(window.opera||-1===window.navigator.userAgent.indexOf("MSIE 5.0"))){var i=document.createElement("iframe");i.setAttribute("id",t),i.style.visibility="hidden",i.style.position="absolute",i.style.width=i.style.height=i.borderWidth="0px",e=document.getElementsByTagName("body")[0].appendChild(i)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeEnd",'<iframe name="'+t+'" id="'+t+'" style="display:none"></iframe>');window.frames&&window.frames[t]&&(e=window.frames[t]),e&&(this.info("Added adal frame to document:"+t),this.event("adalAddIframe",{resource:t}))}return e}},AuthenticationContext.prototype._saveItem=function(t,e){return this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation?this._supportsLocalStorage()?(localStorage.setItem(t,e),!0):(this.info("Local storage is not supported"),!1):this._supportsSessionStorage()?(sessionStorage.setItem(t,e),!0):(this.info("Session storage is not supported"),!1)},AuthenticationContext.prototype._getItem=function(t){return this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation?this._supportsLocalStorage()?localStorage.getItem(t):(this.info("Local storage is not supported"),null):this._supportsSessionStorage()?sessionStorage.getItem(t):(this.info("Session storage is not supported"),null)},AuthenticationContext.prototype._supportsLocalStorage=function(){try{return"localStorage"in window&&window.localStorage}catch(t){return!1}},AuthenticationContext.prototype._supportsSessionStorage=function(){try{return"sessionStorage"in window&&window.sessionStorage}catch(t){return!1}},AuthenticationContext.prototype._cloneConfig=function(t){if(null===t||"object"!=typeof t)return t;var e={};for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},AuthenticationContext.prototype._addLibMetadata=function(){return"&x-client-SKU=Js&x-client-Ver="+this._libVersion()},AuthenticationContext.prototype.log=function(t,e,i){if(t<=Logging.level){var n=this.config.correlationId,o=(new Date).toUTCString()+":"+n+"-"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[t]+" "+e;i&&(o+="\nstack:\n"+i.stack),Logging.log(o)}},AuthenticationContext.prototype.tryLogtoTopFrame=function(t,e,i){if(window.self!==window.top){var n=window.top?window.top.AuthenticationLogger:void 0,o="Iframe - AuthenticationContext: {0}, {1}";i&&(o+=", {2}"),n&&n[t]&&n[t].call(n,o,this.config.correlationId,e,i)}},AuthenticationContext.prototype.trySendEventToTopFrame=function(t,e){if(window.self!==window.top){var i=window.top?window.top.AuthenticationLogEventCallback:void 0;i&&i(t,e)}},AuthenticationContext.prototype.error=function(t,e){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,t,e),this.tryLogtoTopFrame("error",t,e)},AuthenticationContext.prototype.warn=function(t){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,t,null),this.tryLogtoTopFrame("warn",t)},AuthenticationContext.prototype.info=function(t){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,t,null),this.tryLogtoTopFrame("info",t)},AuthenticationContext.prototype.verbose=function(t){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,t,null),this.tryLogtoTopFrame("verbose",t)},AuthenticationContext.prototype.event=function(t,e){this.trySendEventToTopFrame(t,e)},AuthenticationContext.prototype._libVersion=function(){return"1.0.9"},sendAppStateChanged("AuthstrapAdalScriptLoaded");</script><script nonce="">!function(){document.addEventListener("DOMContentLoaded",function(){sendAppStateChanged("AuthstrapDomContentLoaded");var t;!function(t){var e;!function(t){var e=function(){function t(t,e,o,n,i,r,a,s,c,h,l,u,d){this.authContext=t,this.redirectUrl=e,this.$window=o,this.feCookieName=n,this.localStorage=i,this.sessionStorage=r,this.console=a,this.document=s,this.lastLocationHashName=c,this.showError=h,this.secureCookie=l,this.enableCookieStore=u,this.signInStateCookieName=d}return t.prototype.isInIFrame=function(){try{return this.$window.self!==this.$window.top}catch(t){return this.showError(t),!0}},t.prototype.updateFECookie=function(t){if(t=t||"",this.enableCookieStore){var e=new Date(Date.now()+432e6);this.document.cookie=this.feCookieName+"="+t+"; expires="+e+"; path=/"+(this.secureCookie?"; secure":"")}else this.document.cookie=this.feCookieName+"="+t+"; path=/"+(this.secureCookie?"; secure":"")},t.prototype.updatePreSignInCookie=function(t){t=t||"";var e=new Date(Date.now()+31536e6);this.document.cookie=this.signInStateCookieName+"="+t+"; expires="+e+"; path=/"+(this.secureCookie?"; secure":"")},t.prototype.sendTelemetry=function(t){var e=this.redirectUrl+"auth/"+t,o=new XMLHttpRequest;o.open("GET",e,!0),o.send(null)},t.prototype.handleRedirect=function(e){this.tryWarnLog("Redirecting to index"),e&&(this.updateFECookie(this.authContext.getCachedToken(e.profile.aud)),this.updatePreSignInCookie("true"));var o=this.redirectUrl,n=function(t,e){return t.length>0&&t.charAt(t.length-1)===e};if(n(o,"/")||(o+="/"),o+="_",t.shouldIgnoreHashForRedirect(this.document.location.hash)&&""===this.document.location.search){var i=this.getLocationForNonLoggedInUser();i?(o+=i,this.localStorage&&this.localStorage.removeItem(t.nonLoggedInUserLocationKey),this.sessionStorage&&this.sessionStorage.removeItem(t.nonLoggedInUserLocationKey)):e&&(o+=this.getLocationForLoggedInUser(e.profile))}else o+=this.document.location.search+this.document.location.hash;this.sessionStorage&&this.sessionStorage.setItem(t.redirect_authstrap_duration,performance.now()),this.document.location.replace(o)},t.prototype.getLocationForNonLoggedInUser=function(){var e="";return this.document.location.hash&&this.document.location.hash.indexOf(t.idTokenString)>=0?e=this.document.location.hash:this.localStorage?e=this.localStorage.getItem(t.nonLoggedInUserLocationKey):this.sessionStorage&&(e=this.sessionStorage.getItem(t.nonLoggedInUserLocationKey)),e},t.prototype.getLocationForLoggedInUser=function(t){var e="",o=this.document.location.hash;return!o&&this.localStorage&&t&&t.oid&&(o=this.localStorage.getItem("ts."+t.oid+"."+this.lastLocationHashName)),o&&(e+="#"+o.replace(/^#|#$/,"")),e},t.prototype.tryWarnLog=function(t){this.console&&console.warn(t)},t.shouldIgnoreHashForRedirect=function(e){return e&&e.indexOf(t.idTokenString)>=0||""===e||"#"===e},t.nonLoggedInUserLocationKey="ts.nonLoggedInUserLocation",t.redirect_authstrap_duration="ts.redirect_authstrap_duration",t.idTokenString="id_token=",t}();t.AuthStrapBase=e}(e=t.auth||(t.auth={}))}(t||(t={}));var t,e=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();!function(t){var o;!function(t){var o=function(o){function n(t,e,n,i,r,a,s,c,h,l,u,d,p,f,g){var I=o.call(this,t,e,n,i,r,a,s,c,h,u,d,p,f)||this;return I.redirectRoute=l,I.enableGuestAccess=g,I.authContext.getLoginError()&&I.console&&I.console.error("Authorization error: "+I.authContext.getLoginError()),I}return e(n,o),n.prototype.storeLocationForNonLoggedInUser=function(){var e=window.location.href.replace(this.redirectUrl,"");0===e.indexOf("/")&&(e=e.substr(1)),e&&this.localStorage&&0!==e.indexOf(this.redirectRoute)&&this.localStorage.setItem(t.AuthStrapBase.nonLoggedInUserLocationKey,e)},n.prototype.shouldLogoutInvalidProfile=function(t){if(!t.profile.aud)return this.tryWarnLog("User profile type is missing aud"),!0;if(!t.profile.oid&&t.profile.altsecid&&0===t.profile.altsecid.indexOf("1:"))return t.profile.oid="msaDefaultOid",!1;var e=t.profile.iss&&t.profile.idp&&t.profile.iss!==t.profile.idp;return e&&!t.profile.oid?(t.profile.oid="aadDefaultOid",!1):e||t.profile.oid&&t.profile.upn?!1:(this.tryWarnLog("User profile is missing oid or upn"),!0)},n.prototype.profileExpiresIn=function(t,e){var o=t&&t.profile&&(t.profile.exp?1e3*parseInt(t.profile.exp,10):Date.now());return o-Date.now()<=6e4*e},n.prototype.shouldLogInInvalidProfile=function(t,e){var o=!t||!t.profile||!this.authContext.getCachedToken(t.profile.aud);return o?(e&&(this.authContext.config.tenant=e),this.tryWarnLog("User profile not found")):e&&t.profile.tid!=e&&this.enableGuestAccess?(this.sendTelemetry("changeTenant?tid="+t.profile.tid+"&newTid="+e),this.tryWarnLog("User is logged into a different tenant"),this.authContext.config.tenant=e,this.authContext.clearCache(),o=!0):(o=this.profileExpiresIn(t,2),o&&this.tryWarnLog("User profile expired")),o},n.prototype.transferUser=function(t){this.updateFECookie(null),this.sendTelemetry("prelogin"),t?(this.tryWarnLog("Logging user in"),window.electronSafeIpc&&window.electronSafeIpc.send("telemetryEvent",{name:"desktop_adal_login",reason:"authstrap"}),this.authContext.login()):(this.tryWarnLog("Logging user out"),window.electronSafeIpc&&window.electronSafeIpc.send("telemetryEvent",{name:"desktop_adal_logout",reason:"authstrap"}),this.authContext.logOut())},n.prototype.setDomainHintIfPresentAsQSP=function(){if(this.document.location.href&&this.authContext.config){var t=this.getQueryParameterByName("domain_hint",this.document.location.href);t&&this.setExtraQueryParameter("domain_hint",t)}},n.prototype.handleWindow=function(){if(window.location.hash.indexOf("AADSTS50000")>=0)return void window.location.assign(this.redirectUrl+"error/incompatible_compliance_policy");if(this.authContext.handleWindowCallback(),this.setDomainHintIfPresentAsQSP(),!this.isInIFrame())try{var t=this.authContext.getCachedUser();this.setLoginHint();var e=this.getQueryParamByName(window.location.href,"tenantId");this.shouldLogInInvalidProfile(t,e)?(this.storeLocationForNonLoggedInUser(),this.transferUser(!0)):this.shouldLogoutInvalidProfile(t)?this.transferUser(!1):(this.sendTelemetry("postlogin"),this.handleRedirect(t))}catch(o){this.showError(o)}},n.prototype.getQueryParameterByName=function(t,e){e||(e=window.location.href),t=t.replace(/[\[\]]/g,"\\$&");var o=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)"),n=o.exec(e);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null},n.prototype.getQueryParamByName=function(t,e){return t?this.getQueryParameterByName(e,t):void 0},n.prototype.setLoginHint=function(){var t=this.getQueryParamByName(window.location.href,"login_hint");t&&this.setExtraQueryParameter("login_hint",t)},n.prototype.setExtraQueryParameter=function(t,e){var o=t+"="+e;this.authContext.config.extraQueryParameter&&this.authContext.config.extraQueryParameter.length>0?this.authContext.config.extraQueryParameter+="&"+o:this.authContext.config.extraQueryParameter=o},n}(t.AuthStrapBase);t.AuthStrap=o}(o=t.auth||(t.auth={}))}(t||(t={}));var t,e=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();!function(t){var o;!function(t){var o=function(t){function o(e,o,n,i,r,a,s,c,h,l,u,d,p){var f=t.call(this,e,o,n,i,r,a,s,c,h,l,u,d,p)||this;return f.adalIdTokenKey="adal.idtoken",f.adalAccessTokenKey="adal.access.token.key",f.adalTokenExpirationKey="adal.expiration.key",f.adalTokenKeys="adal.token.keys",f.defaultNativeAuthTokenExpirationTimeUnderUwpPPI=3600,f}return e(o,t),o.prototype.isRunningInPPIUwpContainer=function(){var t=this.$window,e=!!(t.Microsoft&&t.Microsoft.PPISkype&&t.Microsoft.PPISkype.Authentication&&t.OAuthToken&&t.OAuthToken.COAuthToken);if(e){var o=t.Microsoft.PPISkype.Authentication.CredentialsHandler.getInstance();e=o.isRunningInPPIOs()}return this.console.warn("Is Running in uwp ppi container?: ",e),e},o.prototype.fetchTokenInPPIUwpContainer=function(t){var e=this.$window,o=e.Microsoft.PPISkype.Authentication.CredentialsHandler.getInstance(),n=o.getPlaintextAllCredentials();if(null==n)return null;var i=e.OAuthToken.COAuthToken.getOrCreateInstance(),r=i.acquireToken(n.signInAddress,n.password,"","","",t);return r},o.prototype.cacheAdalOAuthTokenInIdTokenCacheUnderPPIUwp=function(t){if(null!=t){if(this.localStorage)try{this.localStorage.setItem(this.adalIdTokenKey,t)}catch(e){this.showError("Failed to set item in local storage "+e)}var o=this.authContext.getCachedUser(),n=!(o&&o.profile&&o.profile.aud&&o.profile.exp);n||this.cacheTokenInAccessCacheUnderPPIUwp(t,o.profile.aud,o.profile.exp)}},o.prototype.cacheTokenInAccessCacheUnderPPIUwp=function(t,e,o){if(null!=t&&this.localStorage)try{o=o?o:Math.round((new Date).getTime()/1e3)+this.defaultNativeAuthTokenExpirationTimeUnderUwpPPI,this.localStorage.setItem(this.adalAccessTokenKey+e,t),this.localStorage.setItem(this.adalTokenExpirationKey+e,o);var n=this.localStorage.getItem(this.adalTokenKeys)||"";n.indexOf(e)<0&&this.localStorage.setItem(this.adalTokenKeys,n+e+"|")}catch(i){this.showError("Failed requests to local storage "+i)}},o.prototype.tryFetchAndCacheIdTokenInPPIUwpContainer=function(){if(this.isRunningInPPIUwpContainer()){var t=this.fetchTokenInPPIUwpContainer(this.authContext.config.clientId);this.cacheAdalOAuthTokenInIdTokenCacheUnderPPIUwp(t)}},o.prototype.handleWindow=function(){if(window.location.hash.indexOf("AADSTS50000")>=0)return void window.location.assign(this.redirectUrl+"error/incompatible_compliance_policy");if(!this.isInIFrame())try{this.tryFetchAndCacheIdTokenInPPIUwpContainer(),this.sendTelemetry("postloginppiuwp");var t=this.authContext.getCachedUser();this.handleRedirect(t)}catch(e){this.showError(e)}},o}(t.AuthStrapBase);t.AuthStrapPPIUwp=o}(o=t.auth||(t.auth={}))}(t||(t={}));var o=void 0,n="https://teams.microsoft.com/";"["===n.charAt(0)&&(n="{SETINENVIRONMENTTRANSFORM}","/"!==n.charAt(n.length-1)&&(n+="/"));var i="5e3ce6c0-2b1f-4285-8d4b-75ee78787346";"["===i.charAt(0)&&(i="5e3ce6c0-2b1f-4285-8d4b-75ee78787346");var r="go",a=n+r,s="[[correlationId]]";"["===s.charAt(0)&&(s=void 0),window.config={redirectUri:a,postLogoutRedirectUri:a,instance:"https://login.microsoftonline.com/",clientId:i,correlationId:s,globalResource:o,cacheLocation:"localStorage",extraQueryParameter:"",enableErrorPageRedirect:"",enableGuestAccess:!0};var c=function(){window.location.assign(n+"error/DOM_storage_disabled")},h=function(t){console.error("Error occurred logging in "+JSON.stringify(t)),window.electronSafeIpc&&window.electronSafeIpc.send("pageContentError"),c()},l=function(){var t="skypeStorageTest";try{return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch(e){return h(e),!1}};if(!l())return void c();var u,d=new AuthenticationContext(config),p=window.Microsoft&&window.Microsoft.PPISkype&&window.Microsoft.PPISkype.Authentication&&window.Microsoft.PPISkype.Authentication.CredentialsHandler&&window.Microsoft.PPISkype.Authentication.CredentialsHandler.getInstance().isRunningInPPIOs();u=p?new t.auth.AuthStrapPPIUwp(d,n,window,"TSAUTHCOOKIE",localStorage,sessionStorage,console,document,"lastLocationHash",h,!0,!0,"TSPREAUTHCOOKIE"):new t.auth.AuthStrap(d,n,window,"TSAUTHCOOKIE",localStorage,sessionStorage,console,document,"lastLocationHash",r,h,!0,!0,"TSPREAUTHCOOKIE",!0),u.handleWindow(),sendAppStateChanged("AuthstrapJsLoaded")})}();</script></head><body data-new-gr-c-s-loaded="true"><style>body{margin:0}#errorContent{display:none;padding-top:32px}#errorContent header{background-color:#293955;color:#fff;text-align:center;padding:5px}#errorContent header,#helpContent{margin-bottom:10px}</style><div id="errorContent"><header><h1>Oops...</h1></header><div id="helpContent"><h3>Looks like we were unable to authenticate.</h3><div>Please verify you are using a supported browser with local storage enabled.</div><div>If viewing in private/incognito mode please try opening a standard tab.</div></div><details><div>Code:&nbsp;<span id="errorCode"></span></div><div>Error:&nbsp;<span id="errorName"></span></div></details></div><script nonce="">sendAppStateChanged("AuthstrapHtmlLoaded");</script>
</body></html>