webpackJsonp([17],{2229:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(2230),n(2232),n(2234),n(2236),n(2238),n(2241)},2230:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2231),s=function(){function e(e,t,n,i,s,a,o){var r=this;this.channelService=e,this.infoPaneService=t,this.channelActionsContext=n,this.rightPaneStateService=i,this.constants=a,this.$scope=o,this.isLoading=!0,this.logger=s.newLogger("InfoPaneSectionChannelDescriptionController"),o.$watch("channelDescriptionCtrl.channel",function(){r.loadDescriptionScenario=s.newScenario(a.scenarios.infoPane.channelDescription.channelDescriptionLoad),r.isLoading=!0,r.populateChannelDescription()})}return e.$inject=["channelService","infoPaneService","channelActionsContext","rightPaneStateService","loggingService","constants","$scope"],e.prototype.populateChannelDescription=function(){var e=this;this.channelDescription=null,this.infoPaneService.messageRenderedFullyPromise.then(function(){e.getChannelDescription().then(function(){e.loadDescriptionScenario.stop()})})},e.prototype.editChannel=function(){this.channel&&(this.rightPaneStateService.isNarrowMode&&this.rightPaneStateService.closeRightPane(),!this.channel.isGeneral&&this.canEditChannelDescription&&(this.channelActionsContext.executeAction(this.channel,teamspace.services.ChannelActionType.EditChannel,null),this.sendBITelemetry()))},Object.defineProperty(e.prototype,"canEditChannelDescription",{get:function(){return this.channelActionsContext.isActionAllowed(this.channel,teamspace.services.ChannelActionType.EditChannel)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPrivateChannel",{get:function(){return this.channel&&this.channel.channelType===teamspace.services.ChannelType.Private},enumerable:!0,configurable:!0}),e.prototype.getChannelDescription=function(){var e=this;if(this.loadDescriptionScenario.mark(this.constants.scenarios.infoPane.channelDescription.getChannelDescription),this.channel){if(this.channel.isGeneral)return this.channelService.getTeamById(this.channel.parentTeamId).then(function(t){return t&&t.description&&(e.channelDescription=t.description,e.isLoading=!1),Promise.resolve()}).catch(function(){e.loadDescriptionScenario.fail({reason:"getChannelDescription getTeamById failed"}),e.logger.warn("Failed to get channel description")});this.channel.description&&(this.channelDescription=this.channel.description,this.isLoading=!1)}return this.isLoading=!1,Promise.resolve()},e.prototype.sendBITelemetry=function(){var e={panelActionOutcome:teamspace.components.PanelActionOutcome.openDialog,panelActionScenario:teamspace.components.PanelActionScenario.infoPaneAddChannelDescription,panelActionScenarioType:teamspace.components.PanelActionScenarioType.openDialog,panelModuleName:teamspace.components.PanelModuleName.infoPaneChannelDescriptionSection,panelModuleType:teamspace.components.PanelModuleType.infoPane,panelSummary:"Click on add channel description to open edit channel dialog"};this.infoPaneService.sendBITelemetry(this.$scope,e)},e}();t.InfoPaneSectionChannelDescriptionController=s,angular.module("teamspace.infoPaneSectionChannelDescription",[]).directive("infoPaneSectionChannelDescription",function(){return{restrict:"E",scope:{},controllerAs:"channelDescriptionCtrl",bindToController:{channel:"<?"},controller:s,templateUrl:"components/right-pane/info-pane/sections/channel-description/info-pane-section-channel-description.html"}}).run(["$templateCache",function(e){e.put("components/right-pane/info-pane/sections/channel-description/info-pane-section-channel-description.html",i)}])},2231:function(e,t){e.exports='<div class="section-container ts-info-pane-channel-description" ng-if="!channelDescriptionCtrl.isLoading &&\n            (channelDescriptionCtrl.channelDescription ||\n            channelDescriptionCtrl.canEditChannelDescription)">\n  <div class="info-pane-section-title-container">\n    <span class="info-pane-section-title app-font-caption-semibold">\n      {{::$root.resources.strings.info_pane_channel_description_title|translate}}\n    </span>\n  </div>\n  <div class="section-content-body-with-icon section-padding-bottom-none" ng-if="channelDescriptionCtrl.isPrivateChannel">\n    <ng-include class="channel-description-lock-svg section-content-body-icon" src="\'svg/icons-private.html\'">\n    </ng-include>\n    <div class="app-small-font app-font-weight-semibold" aria-label="{{::$root.resources.strings.info_pane_channel_description_private_channel|translate}}">\n      {{::$root.resources.strings.info_pane_channel_description_private_channel|translate}}\n    </div>\n  </div>\n\n  <div class="section-content-body section-padding-bottom-small">\n    <div class="description-content" ng-if="channelDescriptionCtrl.channelDescription" aria-label="{{channelDescriptionCtrl.channelDescription}}">\n      {{channelDescriptionCtrl.channelDescription}}\n    </div>\n    <div acc-role="tab-handler-info-pane-add-channel-description">\n      <span ng-if="!channelDescriptionCtrl.channelDescription" ng-click="channelDescriptionCtrl.editChannel()" data-tid="info-pane-add-channel-description" tabindex="-1" class="section-link">\n          {{::$root.resources.strings.info_pane_add_channel_description|translate}}\n      </span>\n    </div>\n  </div>\n</div>\n'},2232:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var s=n(2233),a=function(e){function t(n,i,s,a,o,r,c,l,p,d,h,u){var v=e.call(this)||this;return v.constants=n,v.$scope=i,v.$translate=s,v.resources=a,v.peoplePaneService=o,v.rightPaneStateService=r,v.dialogService=c,v.navigationService=l,v.accessibilityService=p,v.utilityService=d,v.infoPaneService=h,v.isLoading=!0,v.isInfoPaneEnabled=u.valueAsBoolean(n.settings.names.enableInfoPane),v.isInitialState=!0,v.titleNoCount=s.instant(a.strings.right_pane_people_title_no_count),v.title=v.titleNoCount,v.loadErrorMessage=s.instant(a.strings.right_pane_people_load_error_message),v.loadErrorBtnLabel=s.instant(a.strings.right_pane_people_load_error_button_label),v.id=d.generateUUID(),o.registerController(v.id),v.ppData=o.emptyPpData,i.$watch("pp.ppData.people",function(){!v.isInfoPaneEnabled&&v.setTitle()}),i.$watch("pp.ppData.isDataLoading",function(){return v.setIsLoading()}),i.$watch("pp.ppData.initialDataLoaded",function(){return v.setIsLoading()}),i.$watch("pp.ppData.channel",function(e,t){v.setViewDashboardString()}),i.$on("$destroy",function(){o.unregisterController(v.id)}),v.registerInitializationListener(i,t.teamThreadIdExpression),v.initialize(),v}return i(t,e),t.$inject=["constants","$scope","$translate","resources","peoplePaneService","rightPaneStateService","dialogService","navigationService","accessibilityService","utilityService","infoPaneService","settingsService"],t.prototype.initialize=function(){!this.rightPaneStateService.isInitialState&&this.isInitialState?(this.isInitialState=!1,this.refresh(!1)):(this.rightPaneStateService.isInitialState=!1,this.isInitialState=!1,this.refresh(!0))},t.prototype.refresh=function(e){var n=this,i=this.peoplePaneService.getData(this.teamThreadId,e);this.utilityService.requestIdlePromise().then(function(){n.peoplePaneService.isPeoplePaneDataCurrent(i)&&(n.ppData=i,n.isInfoPaneEnabled&&n.peoplePaneService.getActiveMembers(n.ppData,n.channel.objectId,t.MAX_ACTIVEMEMBER,t.MAX_REPLYCHAINFETCH).then(function(e){n.activeMembers=e}))})},Object.defineProperty(t.prototype,"showAllMember",{get:function(){return!this.isInfoPaneEnabled||this.ppData.people&&this.ppData.people.length>0&&(!this.activeMembers||this.activeMembers.length<this.ppData.people.length)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showActiveMember",{get:function(){return this.activeMembers&&this.activeMembers.length>0},enumerable:!0,configurable:!0}),t.prototype.goToInfoPane=function(){this.infoPaneService.goToTopView()},t.prototype.closeRightPane=function(){this.rightPaneStateService.closeRightPane()},t.prototype.openAddMembersDialog=function(){this.narrowMode&&this.closeRightPane(),this.dialogService.open(this.constants.dialogs.addMembers,this.peoplePaneService.getAddMemberData(this.ppData))},t.prototype.viewTeamDashboard=function(){this.narrowMode&&this.closeRightPane();var e=this.peoplePaneService.getDashboardNavigationData(this.ppData);this.navigationService.navigate(this.$scope,e.state,e.navData)},t.prototype.onUserKeyDown=function(e){this.accessibilityService.isInKeyboardNavigationMode()&&e.which===this.constants.keyCodes.enter&&this.showUserInfo(e)},t.prototype.onUserClick=function(e){this.accessibilityService.isInKeyboardNavigationMode()&&this.showUserInfo(e)},t.prototype.showUserInfo=function(e){e.preventDefault();var t=angular.element("profile-picture",e.target);t.length&&t.click()},t.prototype.setTitle=function(){this.title=this.ppData&&this.ppData.people&&this.ppData.people.length?this.$translate.instant(this.resources.strings.right_pane_people_title,{peopleCount:this.ppData.people.length}):this.titleNoCount},t.prototype.setViewDashboardString=function(){this.viewDashboardString=this.isSpecialChannelContext()?this.$translate.instant(this.resources.strings.channel_dashboard_view):this.$translate.instant(this.resources.strings.team_dashboard_view_dashboard)},t.prototype.setIsLoading=function(){this.isLoading=this.ppData&&!this.ppData.initialDataLoaded&&this.ppData.isDataLoading},t.prototype.isSpecialChannelContext=function(){return this.ppData&&this.ppData.channel&&this.ppData.channel.channelType===teamspace.services.ChannelType.Private},t.teamThreadIdExpression="pp.teamThreadId",t.MAX_ACTIVEMEMBER=15,t.MAX_REPLYCHAINFETCH=50,t}(teamspace.components.BaseController);t.PeoplePaneController=a,angular.module("teamspace.peoplePane",["teamspace.peoplePaneService","pascalprecht.translate","teamspace.locales","teamspace.constants","teamspace.rightPaneStateService","teamspace.dialogService","teamspace.navigationService","teamspace.accessibilityService","teamspace.utilityService"]).directive("peoplePane",["constants",function(e){return{restrict:"E",scope:{},controllerAs:"pp",bindToController:{teamThreadId:"<",narrowMode:"<?",channel:"<?"},controller:a,templateUrl:e.files.templates.peoplePane}}]).run(["$templateCache",function(e){e.put("components/right-pane/people/people-pane.html",s)}])},2233:function(e,t){e.exports='<div class="ts-people-pane flex-fill">\n  <div class="ts-right-pane-title-container">\n    <button type="button" class="ts-sym app-icons-fill-hover back-button" ng-click="pp.goToInfoPane()" aria-label="{{::$root.resources.strings.navigate_to_info_pane|translate}}" title="{{::$root.resources.strings.navigate_to_info_pane|translate}}" data-tid="peoplePane-GoToInfoPane" track-summary="Navigate back to info pane" ng-if="pp.isInfoPaneEnabled">\n      <ng-include src="\'svg/icons-chevronmed-left.html\'"></ng-include>\n    </button>\n    <span class="ts-right-pane-title clickable" ng-bind="pp.title" id="right-pane-people-pane-label" ng-click="pp.goToInfoPane()"></span>\n    <button acc-role-dom="tab-handler-close-people-pane" type="button" class="ts-sym app-icons-fill-hover ts-right-pane-close-btn" title="{{::$root.resources.strings.right_pane_people_close|translate}}" aria-label="{{::$root.resources.strings.right_pane_people_close|translate}}" ng-click="pp.closeRightPane()" ng-if="!pp.isInfoPaneEnabled">\n      <ng-include src="\'svg/icons-close.html\'"></ng-include>\n    </button>\n  </div>\n  <div ng-if="pp.isLoading" class="busy-container flex-fill">\n    <busy-animation size="medium"></busy-animation>\n  </div>\n  <div ng-if="pp.ppData.isError" class="ts-right-pane-error flex-fill">\n    <img src="https://statics.teams.cdn.office.net/hashedassets/SomethingWentWrong_EmptyState-fa922e0.svg"/>\n    <p ng-bind="pp.loadErrorMessage"></p>\n    <button ng-click="pp.refresh(false)" class="ts-btn ts-btn-primary" ng-bind="pp.loadErrorBtnLabel">\n    </button>\n  </div>\n  <div class="ts-right-pane-people flex-fill" ng-if="!pp.isLoading && !pp.ppData.isError">\n    <div class="right-pane-content flex-fill scroll-container">\n      <div class="ts-people-vs-container" simple-scrollbar>\n        <div class="flex-fill">\n          <div translate-once="{{::$root.resources.strings.right_pane_people_recently_contributed}}" class="app-font-caption-semibold ts-people-pane-sub-title" ng-if="pp.isInfoPaneEnabled && pp.showActiveMember"></div>\n          <ul acc-role="listgrid-vertical" aria-labelledby="right-pane-people-pane-label">\n            <li ng-repeat="user in pp.activeMembers track by user.mri" ng-if="pp.isInfoPaneEnabled && pp.showActiveMember" type="button" id="right-pane-first-element-to-focus" class="keyboard-navigation-outline" ng-keydown="pp.onUserKeyDown($event)" ng-click="pp.onUserClick($event)" acc-role="listgrid-item" aria-posinset="{{($index + 1)}}" aria-setsize="{{pp.ppData.people.length}}" aria-label="{{::(user.role && user.role.toLowerCase() == \'guest\' ?\n                ($root.resources.strings.right_pane_people_user_card_aria_label_guest|translate:{userName:user.displayName}) : user.displayName)}}">\n              <user-card display-name="{{::user.displayName}}" mri="{{::user.mri}}" upn="{{::user.userPrincipalName}}" user-role="{{::user.role}}">\n              </user-card>\n            </li>\n          </ul>\n          <div class="app-font-caption-semibold ts-people-pane-sub-title" ng-if="pp.isInfoPaneEnabled && pp.showAllMember">\n              <span translate-once="{{::$root.resources.strings.right_pane_people_all}}"></span>\n              <span>({{::pp.ppData.people.length}})</span>\n          </div>\n          <ul acc-role="listgrid-vertical" ng-if="pp.showAllMember" aria-labelledby="right-pane-people-pane-label" vs-repeat="44" vs-excess="10" vs-scroll-parent=".ts-people-vs-container" vs-check-client-size="true">\n            <li ng-repeat="user in pp.ppData.people track by user.mri" type="button" id="right-pane-first-element-to-focus" class="keyboard-navigation-outline" ng-keydown="pp.onUserKeyDown($event)" ng-click="pp.onUserClick($event)" acc-role="listgrid-item" aria-posinset="{{($index + 1)}}" aria-setsize="{{pp.ppData.people.length}}" aria-label="{{::(user.role && user.role.toLowerCase() == \'guest\' ?\n                ($root.resources.strings.right_pane_people_user_card_aria_label_guest|translate:{userName:user.displayName}) : user.displayName)}}">\n              <user-card display-name="{{::user.displayName}}" mri="{{::user.mri}}" upn="{{::user.userPrincipalName}}" user-role="{{::user.role}}">\n              </user-card>\n            </li>\n          </ul>\n        </div>\n      </div>\n    </div>\n    \x3c!-- Wait until channel is resolved to prevent flashing--\x3e\n    <div class="right-pane-bottom" ng-if="pp.ppData.channel">\n      <div ng-if="pp.ppData.canCurrentUserAddPeople" class="flex-fill bottom-container">\n        <button type="button" class="ts-sym has-icon focus-round-border" ng-click="pp.openAddMembersDialog()" aria-label="{{::$root.resources.strings.team_add_members|translate}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.addPeople}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.rightRail}}" track-name="{{::$root.trackConstants.trackModuleName.peoplePaneAddPeopleButton}}" track-type="{{::$root.trackConstants.trackType.button}}" track-summary="People Pane Add People Button">\n          <ng-include class="icon" src="\'svg/icons-add-participant.html\'"></ng-include>\n          <span class="ts-popover-label" translate-once="{{::$root.resources.strings.team_add_members}}"></span>\n        </button>\n        <button type="button" class="ts-sym has-icon" ng-click="pp.viewTeamDashboard()" title="{{::pp.viewDashboardString}}" aria-label="{{::pp.viewDashboardString}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.manageTeam}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.rightRail}}" track-name="{{::$root.trackConstants.trackModuleName.peoplePaneManageTeamButton}}" track-type="{{::$root.trackConstants.trackType.button}}" track-data="{isOwner: true}" track-summary="People Pane Manage Team Button">\n          <ng-include class="icon" src="\'svg/icons-settings.html\'"></ng-include>\n        </button>\n      </div>\n      <div ng-if="!pp.ppData.canCurrentUserAddPeople" class="flex-fill bottom-container">\n        <button type="button" class="ts-sym has-icon" ng-click="pp.viewTeamDashboard()" title="{{::pp.viewDashboardString}}" aria-label="{{::pp.viewDashboardString}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.manageTeam}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.rightRail}}" track-name="{{::$root.trackConstants.trackModuleName.peoplePaneManageTeamButton}}" track-type="{{::$root.trackConstants.trackType.button}}" track-data="{isOwner: false}" track-summary="People Pane Manage Team Button">\n          <ng-include class="icon" src="\'svg/icons-settings.html\'"></ng-include>\n          <span class="ts-popover-label" ng-bind="pp.viewDashboardString"></span>\n        </button>\n      </div>\n    </div>\n  </div>\n</div>'},2234:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,s=n(2235);!function(e){e[e.Active=0]="Active",e[e.All=1]="All"}(i=t.PeopleSectionType||(t.PeopleSectionType={}));var a=function(){function e(e,t,n,i,s,a,o,r,c,l,p,d){var h=this;this.infoPaneService=t,this.peoplePaneService=n,this.navigationService=i,this.dialogService=s,this.rightPaneStateService=a,this.teamMembershipPropertiesService=o,this.constants=c,this.$translate=l,this.resources=p,this.$scope=d,this.isLoading=!0,this.peopleSectionList=[],this.peopleData=null,this.MAX_ACTIVEMEMBER=10,this.MAX_ALLMEMBER=12,this.MAX_REPLYCHAINCOUNT=20,this.controllerId=e.generateUUID(),n.registerController(this.controllerId),this.peopleData=n.emptyPpData,this.initializePeopleSectionList(),this.logger=r.newLogger("InfoPaneSectionPeopleController"),d.$watch("peopleCtrl.channel",function(){h.isLoading=!0,h.refresh()}),d.$watch("peopleCtrl.peopleData.people",function(){h.peopleData&&!h.peopleData.isDataLoading&&h.peopleData.people&&h.peopleData.people.length>0&&h.calculatePeopleSectionList()}),d.$on("$destroy",function(){n.unregisterController(h.controllerId)})}return e.$inject=["utilityService","infoPaneService","peoplePaneService","navigationService","dialogService","rightPaneStateService","teamMembershipPropertiesService","loggingService","constants","$translate","resources","$scope"],e.prototype.seeAll=function(){this.infoPaneService.navigateTo(teamspace.services.InfoPaneSections.ACTIVEMEMBER)},e.prototype.viewTeamDashboard=function(){var e=this.peoplePaneService.getDashboardNavigationData(this.peopleData);this.navigationService.navigatePromise(this.$scope,e.state,e.navData),this.seeAllMembersBITelemetry()},e.prototype.addMember=function(){var e=this.peoplePaneService.getAddMemberData(this.peopleData),t=e&&e.team;this.rightPaneStateService.isNarrowMode&&this.rightPaneStateService.closeRightPane(),this.isAdmin||t&&t.visibility===this.constants.teams.visibility.public&&!t.isTenantWide?this.dialogService.open(this.constants.dialogs.addMembers,e):this.dialogService.open(this.constants.dialogs.wizard,{rootStep:{context:{shallowTeam:new teamspace.components.MemberAddMemberTeam(t)},directive:this.constants.memberAddMemberStages.memberAdd}}),this.addMembersBITelemetry()},Object.defineProperty(e.prototype,"viewDashboardString",{get:function(){return this.peopleSectionList&&this.peopleSectionList[i.All]&&this.peopleSectionList[i.All].memberList&&this.peopleSectionList[i.All].memberList.length>0?this.$translate.instant(this.resources.strings.info_pane_see_full_list):this.$translate.instant(this.resources.strings.info_pane_see_all_members)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPrivateChannel",{get:function(){return this.channel&&this.channel.channelType===teamspace.services.ChannelType.Private},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"membersCount",{get:function(){var e=this;return this.peopleData&&this.peopleData.people?_.filter(this.peopleData.people,function(t){return t.role!==e.constants.RoleConstants.Guest}).length:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activeMemberCount",{get:function(){return this.peopleSectionList&&this.peopleSectionList[i.Active]&&this.peopleSectionList[i.Active].memberList?this.peopleSectionList[i.Active].memberList.length:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalMemberCount",{get:function(){return this.membersCount+this.guestsCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAdmin",{get:function(){return this.teamMembershipPropertiesService.getRole(this.channel&&this.channel.parentTeamId)===this.constants.RoleConstants.Admin},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"guestsCount",{get:function(){var e=this;return this.peopleData&&this.peopleData.people?_.filter(this.peopleData.people,function(t){return t.role===e.constants.RoleConstants.Guest}).length:0},enumerable:!0,configurable:!0}),e.prototype.initializePeopleSectionList=function(){this.peopleSectionList.push({title:this.$translate.instant(this.resources.strings.info_pane_section_people_recently_contributed),memberList:[]}),this.peopleSectionList.push({title:this.$translate.instant(this.resources.strings.info_pane_section_people_all),memberList:[]})},e.prototype.refresh=function(){var e=this;this.infoPaneService.messageRenderedFullyPromise.then(function(){var t=e.peoplePaneService.getData(e.channel.objectId,!1);e.peoplePaneService.isPeoplePaneDataCurrent(t)&&(e.peopleData=t,t&&t.people&&t.people.length>0&&e.calculatePeopleSectionList())})},e.prototype.calculatePeopleSectionList=function(){var e=this;this.peoplePaneService.getActiveMembers(this.peopleData,this.channel.objectId,this.MAX_ACTIVEMEMBER,this.MAX_REPLYCHAINCOUNT).then(function(t){if(e.peopleSectionList[i.Active].memberList=t,e.peopleSectionList[i.Active].memberList.length<e.MAX_ACTIVEMEMBER){var n=e.MAX_ALLMEMBER-e.peopleSectionList[i.Active].memberList.length;e.peopleSectionList[i.All].memberList=e.peopleData.people.slice(0,n)}else e.peopleSectionList[i.All].memberList=[]}).catch(function(t){e.logger.warn("Error while fetching active members in current channel: {0}",t)}).finally(function(){e.isLoading=!1})},e.prototype.seeAllMembersBITelemetry=function(){var e={panelActionOutcome:teamspace.components.PanelActionOutcome.nav,panelActionScenario:teamspace.components.PanelActionScenario.infoPaneSeeAllMembers,panelActionScenarioType:teamspace.components.PanelActionScenarioType.nav,panelModuleName:teamspace.components.PanelModuleName.infoPaneMembersSection,panelModuleType:teamspace.components.PanelModuleType.infoPane,panelSummary:"Click on see all members button to navigate to teams dashboard"};this.infoPaneService.sendBITelemetry(this.$scope,e)},e.prototype.addMembersBITelemetry=function(){var e={panelActionOutcome:teamspace.components.PanelActionOutcome.openDialog,panelActionScenario:teamspace.components.PanelActionScenario.infoPaneAddMembers,panelActionScenarioType:teamspace.components.PanelActionScenarioType.openDialog,panelModuleName:teamspace.components.PanelModuleName.infoPaneMembersSection,panelModuleType:teamspace.components.PanelModuleType.infoPane,panelSummary:"Click on add member button to add member or request to add member to channel"};this.infoPaneService.sendBITelemetry(this.$scope,e)},e}();t.InfoPaneSectionPeopleController=a,angular.module("teamspace.infoPaneSectionPeople",["teamspace.peoplePaneService"]).directive("infoPaneSectionPeople",function(){return{restrict:"E",scope:{},controllerAs:"peopleCtrl",bindToController:{channel:"<?"},controller:a,templateUrl:"components/right-pane/info-pane/sections/people/info-pane-section-people.html"}}).run(["$templateCache",function(e){e.put("components/right-pane/info-pane/sections/people/info-pane-section-people.html",s)}])},2235:function(e,t){e.exports='<div class="section-container" ng-if="!peopleCtrl.isLoading">\n  <div class="info-pane-section-title-container info-pane-section-member-title">\n    <span class="info-pane-section-title app-font-caption-semibold" id="right-pane-people-pane-label">\n        {{($root.resources.strings.info_pane_title|translate:{count:peopleCtrl.totalMemberCount})}}\n    </span>\n    <span class="add-member-button" acc-role="tab-handler-info-pane-add-members">\n      <button type="button" class="ts-sym app-icons-fill-hover" ng-click="peopleCtrl.addMember()" data-tid="info-pane-add-member-button" title="{{::$root.resources.strings.info_pane_add_members_button_title|translate}}" aria-label="{{::$root.resources.strings.info_pane_add_members_button_title|translate}}">\n        <ng-include src="\'svg/icons-team-create.html\'" class="icon ng-scope">\n        </ng-include>\n      </button>\n    </span>\n\n  </div>\n\n  <div class="section-content-body info-pane-people-section" acc-role="tab-handler-info-pane-member-list">\n    <div ng-repeat="section in peopleCtrl.peopleSectionList" ng-if="section.memberList && section.memberList.length > 0">\n      <div class="section-title">\n        <span class="app-small-font" aria-label="{{::section.title}}">\n              {{::section.title}}\n        </span>\n      </div>\n\n      \x3c!-- vertical view --\x3e\n      <div class="right-pane-content flex-fill scroll-container">\n        <div class="ts-people-vs-container">\n          <ul class="flex-fill horizon-list" data-tid="info-pane-member-list-{{($index+1)}}" acc-role="listgrid-vertical" aria-labelledby="right-pane-people-pane-label">\n            <li ng-repeat="user in section.memberList track by user.mri" type="button" tabindex="-1" acc-role="listgrid-item" class="info-pane-member-list-item" aria-posinset="{{($index + 1)}}" aria-setsize="{{section.memberList}}" aria-label="{{::(user.role && user.role.toLowerCase() == \'guest\' ? ($root.resources.strings.right_pane_people_user_card_aria_label_guest|translate:{userName:user.displayName}) : user.displayName)}}">\n              <user-card display-name="{{::user.displayName}}" mri="{{::user.mri}}" upn="{{::user.userPrincipalName}}" user-role="{{::user.role}}">\n              </user-card>\n            </li>\n          </ul>\n        </div>\n      </div>\n    </div>\n    <div acc-role="tab-handler-info-pane-see-all-members-button">\n      <span class="section-link people-section-link" tabindex="-1" data-tid="info-pane-see-all-members-button" ng-click="peopleCtrl.viewTeamDashboard()">\n        {{::peopleCtrl.viewDashboardString}}\n      </span>\n    </div>\n  </div>\n</div>'},2236:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2237),s=function(){function e(e,t,n,i,s,a,o){this.$scope=e,this.channelService=n,this.navigationService=i,this.announcementsIllustrationsService=o,this.enableAnnouncementsIllustrationsConsumption=a.valueAsBoolean(t.settings.names.enableAnnouncementsIllustrationsConsumption),this.announcementBackgroundPosition=null,this.viewModel&&(this.subject=this.viewModel.subject,this.title=this.viewModel.title,this.body=this.viewModel.body,this.displayName=this.viewModel.displayName,this.isAnnouncement=this.viewModel.layoutType===teamspace.components.MessageLayoutType.ANNOUNCEMENT,this.isNormalMessage=this.viewModel.layoutType===teamspace.components.MessageLayoutType.NORMAL,this.viewModel.isMessageSentToday?this.timeStamp=s.getDate(this.viewModel.originalArrivalTime,"shortTime"):this.timeStamp=s.getDate(this.viewModel.originalArrivalTime,"longDate"),this.isAnnouncement&&this.setAnnouncementBackgroundProperties())}return e.$inject=["$scope","constants","channelService","navigationService","localizationService","settingsService","announcementsIllustrationsService"],e.prototype.openDeeplink=function(){if(this.viewModel){var e=this.channelService.getParentTeamAndChannelByChannelId(this.viewModel.conversationId),t=e&&e.channel&&e.channel.displayName,n=e&&e.team&&e.team.displayName;return this.navigationService.navigateToMessage(this.$scope,this.viewModel.originalArrivalTime,this.viewModel.conversationId,this.viewModel.id,this.viewModel.parentMessageId,this.viewModel.id,"PinPostPane",n,t)}},e.prototype.setAnnouncementBackgroundProperties=function(){this.viewModel.layoutMetadata&&this.viewModel.layoutMetadata.header&&this.viewModel.layoutMetadata.header.imageData?this.enableAnnouncementsIllustrationsConsumption?(this.announcementBackgroundPosition=this.announcementsIllustrationsService.getAnnouncementBackgroundPosition(this.viewModel.layoutMetadata.header.imageData,!0),this.announcementHeaderImgUrl=this.announcementsIllustrationsService.getAnnouncementHeaderImgUrl(this.viewModel.layoutMetadata.header.imageData)):this.viewModel.layoutMetadata.header.imageData.croppedImage&&this.viewModel.layoutMetadata.header.imageData.croppedImage.src&&(this.announcementHeaderImgUrl=this.viewModel.layoutMetadata.header.imageData.croppedImage.src):this.viewModel.layoutMetadata&&this.viewModel.layoutMetadata.header&&this.viewModel.layoutMetadata.header.bgColorClass&&(this.bgColorClass=this.viewModel.layoutMetadata.header.bgColorClass)},e}();t.PinPostThreadCardController=s;var a=function(e){return{restrict:"E",controllerAs:"pinPostMessageCardCtrl",controller:s,bindToController:{viewModel:"<?"},templateUrl:e}};angular.module("teamspace.pinPostMessageCard",[]).directive("pinPostMessageCard",function(){return a("components/right-pane/info-pane/pin-post-cards/pin-post-message-card.html")}).run(["$templateCache",function(e){e.put("components/right-pane/info-pane/pin-post-cards/pin-post-message-card.html",i)}])},2237:function(e,t){e.exports='<div class="ts-pin-post-message-card shadow-level-1" ng-if="pinPostMessageCardCtrl.isNormalMessage && pinPostMessageCardCtrl.subject" ng-click="pinPostMessageCardCtrl.openDeeplink()">\n  <div class="ts-pp-content">\n    <div class="ts-pp-msg-subject">{{pinPostMessageCardCtrl.subject}}</div>\n    <div class="ts-pp-msg-body">{{pinPostMessageCardCtrl.body}}</div>\n    <div class="ts-pp-msg-timestamp-container">\n      <span class="ts-pp-msg-displayName app-small-font">{{pinPostMessageCardCtrl.displayName}}</span>\n      <span class="timestamp-column ts-pp-msg-timeStamp">{{pinPostMessageCardCtrl.timeStamp}}</span>\n    </div>\n  </div>\n</div>\n\n<div class="ts-pin-post-message-card shadow-level-1" ng-if="pinPostMessageCardCtrl.isNormalMessage && !pinPostMessageCardCtrl.subject" ng-click="pinPostMessageCardCtrl.openDeeplink()">\n  <div class="ts-pp-content">\n    <div class="ts-pp-msg-body-no-subject-container">\n      <div class="ts-pp-msg-body-no-subject">\n        {{pinPostMessageCardCtrl.body}}\n      </div>\n    </div>\n    <div class="ts-pp-msg-timestamp-container">\n      <div class="ts-pp-msg-displayName app-small-font">{{pinPostMessageCardCtrl.displayName}}</div>\n      <div class="timestamp-column ts-pp-msg-timeStamp">{{pinPostMessageCardCtrl.timeStamp}}</div>\n    </div>\n  </div>\n</div>\n\n<div class="ts-pin-post-message-card shadow-level-1 announcement" ng-if="pinPostMessageCardCtrl.isAnnouncement" ng-click="pinPostMessageCardCtrl.openDeeplink()" ng-class="pinPostMessageCardCtrl.announcementBackgroundPosition" ng-style="pinPostMessageCardCtrl.announcementHeaderImgUrl &&\n       { \'background-image\' : \'url(\' + pinPostMessageCardCtrl.announcementHeaderImgUrl + \')\' }">\n  <div ng-class="[{ \'bgColor\': pinPostMessageCardCtrl.bgColorClass }, pinPostMessageCardCtrl.bgColorClass]" class="rounded-corner">\n    <div class="ts-pp-content" ng-class="{ \'announcement-background-img-overlay\': !pinPostMessageCardCtrl.bgColorClass }">\n      <div class="ts-pp-msg-subject ts-pp-msg-subject-announcement">\n        <ng-include class="icons-white-override announcement-icon" src="\'svg/icons-megaphone.html\'">\n        </ng-include>\n        <span class="announcement-subject">{{pinPostMessageCardCtrl.title}}</span>\n      </div>\n      <div class="ts-pp-msg-body announcement-body">{{pinPostMessageCardCtrl.body}}</div>\n      <div class="ts-pp-msg-timestamp-container">\n        <span class="ts-pp-msg-displayName app-small-font announcement-displayName">{{pinPostMessageCardCtrl.displayName}}</span>\n        <span class="timestamp-column ts-pp-msg-timeStamp announcement">{{pinPostMessageCardCtrl.timeStamp}}</span>\n      </div>\n    </div>\n  </div>\n</div>'},2238:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2239),s=n(2240),a=function(){function e(e,t,n,i,s,a,o,r){var c=this;this.$scope=e,this.$q=t,this.$element=n,this.constants=i,this.pinPostService=s,this.infoPaneService=a,this.loggingService=o,this.conversationsService=r,this.readPosts=[],this.unreadPosts=[],this.previewPosts=[],this.isLoading=!1,this.posts=[],this.pinnedConsumptionHorizon=null,this.defaultPageSize=20,this.defaultPreviewPageSize=5,this.init(),e.$on("$destroy",function(){c.unsubscribeAllSubscriptions()})}return e.$inject=["$scope","$q","$element","constants","pinPostService","infoPaneService","loggingService","conversationsService"],e.prototype.init=function(){var e=this;this.logger=this.loggingService.newLogger("pin-post-pane");var t=this.$element.find(".pinned-post-list-wrapper");t&&t.on("scroll",function(t){return e.onScroll(t)}),this.resetPane(),this.getPinnedConsumptionHorizon(),this.loadPinnedPostsForCurrentChannel().then(function(){e.updatePinnedConsumptionHorizon(e.channel),e.$scope.$watch("pinPostPaneCtrl.channel",function(){e.channel&&e.previousChannel&&e.previousChannel!==e.channel&&e.onChannelSwitch(),e.previousChannel=e.channel}),e.subscribeToPinPostService()})},e.prototype.loadMorePinnedPosts=function(){this.loadPinnedPostsForCurrentChannel(!0)},e.prototype.onScroll=function(e){e&&e.target&&e.target.scrollTop+e.target.clientHeight+10>e.target.scrollHeight&&this.loadMorePinnedPosts()},e.prototype.resetPane=function(){this.posts=[],this.previewPosts=[],this.readPosts=[],this.unreadPosts=[],this.isLoading=!1,this.latestMessageId=void 0},e.prototype.loadPinnedPostsForCurrentChannel=function(e){var t=this;return void 0===e&&(e=!1),this.channel&&!this.isLoading?(this.isLoading=!0,this.infoPaneService.messageRenderedFullyPromise.then(function(){t.pinPostService.getPinnedPost(t.channel.parentTeamId,t.channel.objectId,t.infoPaneService.isTopView?t.defaultPreviewPageSize:t.defaultPageSize,e?_.last(t.posts):null).then(function(n){t.posts=e?_.uniqBy(_.concat(t.posts,n),function(e){return e.id}):n,t.refreshView(),t.isLoading=!1}).catch(function(e){t.isLoading=!1,"task cancelled"!==e&&t.logger.error("Failed to loadPinnedPostsForCurrentChannel, error: "+e)})})):this.$q.resolve()},e.prototype.onChannelSwitch=function(){var e=this;this.updatePinnedConsumptionHorizon(this.previousChannel),this.resetPane(),this.pinPostService.reset(),this.getPinnedConsumptionHorizon(),this.loadPinnedPostsForCurrentChannel().then(function(){return e.subscribeToPinPostService()})},e.prototype.updatePinnedConsumptionHorizon=function(e){var t=this;e&&this.infoPaneService.currentSection===teamspace.services.InfoPaneSections.PINPOST&&this.unreadPosts.length>0&&this.pinPostService.updatePinnedConsumptionHorizon(e.parentTeamId,e.objectId,""+(new Date).getTime()).then(function(){t.getPinnedConsumptionHorizon()})},e.prototype.refreshView=function(){this.loadMessagePreview(),this.loadUnreadMessages(),this.loadReadMessages()},e.prototype.loadMessagePreview=function(){this.previewPosts=_.take(this.posts,e.MAX_PREVIEWMESSAGES)},e.prototype.loadUnreadMessages=function(){var e=this;this.unreadPosts=_.filter(this.posts,function(t){return parseInt(t.pinnedTime)>e.pinnedConsumptionHorizon})},e.prototype.loadReadMessages=function(){var e=this;this.readPosts=_.filter(this.posts,function(t){return parseInt(t.pinnedTime)<=e.pinnedConsumptionHorizon})},e.prototype.subscribeToPinPostService=function(){var e=this;this.unsubscribeAllSubscriptions(),this.onPinRemoveSubToken||(this.onPinRemoveSubToken=this.pinPostService.safeSubscribe(this.$scope,function(t,n){return e.onPinRemoved(n&&n.post)},this.constants.events.pinpost.removed)),this.onPinUpdateSubToken||(this.onPinUpdateSubToken=this.pinPostService.safeSubscribe(this.$scope,function(t,n){return e.onPinUpdate(n&&n.post)},this.constants.events.pinpost.updated))},e.prototype.unsubscribeAllSubscriptions=function(){this.onPinRemoveSubToken&&(this.pinPostService.unsubscribe(this.onPinRemoveSubToken),this.onPinRemoveSubToken=null),this.onPinUpdateSubToken&&(this.pinPostService.unsubscribe(this.onPinUpdateSubToken),this.onPinUpdateSubToken=null)},e.prototype.onPinUpdate=function(e){if(e&&this.channel&&this.channel.objectId===e.conversationId){var t=_.findIndex(this.posts,function(t){return t.id===e.id});t>=0?(this.posts[t]=e,this.refreshView()):this.onPinAdd(e)}},e.prototype.onPinAdd=function(e){e&&this.channel&&this.channel.objectId===e.conversationId&&(this.posts.unshift(e),this.latestMessageId=e.id,this.refreshView())},e.prototype.onPinRemoved=function(e){e&&this.channel&&this.channel.objectId===e.conversationId&&(_.remove(this.posts,function(t){return t.id===e.id}),this.refreshView())},e.prototype.getPinnedConsumptionHorizon=function(){if(this.channel){var e=this.conversationsService.getConversation(this.channel.objectId);e&&(this.pinnedConsumptionHorizon=e.getPinnedConsumptionHorizonOriginalArrivalTime())}},e.prototype.goToInfoPane=function(){this.latestMessageId=void 0,this.infoPaneService.goToTopView(),this.updatePinnedConsumptionHorizon(this.channel),this.sendBITelemetry(teamspace.components.PanelActionScenario.infoPaneGoBackToInfoPane,teamspace.components.PanelModuleName.PinnedPostSection,"Click on go back to info pane button to navigate from pinned posts pane to info pane")},e.prototype.seeMore=function(){this.latestMessageId=void 0,this.infoPaneService.navigateTo(teamspace.services.InfoPaneSections.PINPOST),this.sendBITelemetry(teamspace.components.PanelActionScenario.infoPaneSeeMorePinnedPosts,teamspace.components.PanelModuleName.PinnedPostSection,"Click on see more pinned posts button to navigate to pinned posts pane")},e.prototype.sendBITelemetry=function(e,t,n){var i={panelActionOutcome:teamspace.components.PanelActionOutcome.nav,panelActionScenario:e,panelActionScenarioType:teamspace.components.PanelActionScenarioType.nav,panelModuleName:t,panelModuleType:teamspace.components.PanelModuleType.infoPane,panelSummary:n};this.infoPaneService.sendBITelemetry(this.$scope,i)},e.MAX_PREVIEWMESSAGES=2,e}();t.PinPostController=a;var o=function(e){return{restrict:"E",scope:{},controllerAs:"pinPostPaneCtrl",bindToController:{channel:"<?"},controller:a,templateUrl:e}};angular.module("teamspace.pinPostPane",["teamspace.pinPostService","teamspace.infoPaneService"]).directive("pinPostPane",function(){return o("components/right-pane/pin-post-pane/pin-post-pane.html")}).directive("infoPaneSectionPinPostPane",function(){return o("components/right-pane/info-pane/sections/pin-post-pane/info-pane-section-pin-post-pane.html")}).run(["$templateCache",function(e){e.put("components/right-pane/pin-post-pane/pin-post-pane.html",i),e.put("components/right-pane/info-pane/sections/pin-post-pane/info-pane-section-pin-post-pane.html",s)}])},2239:function(e,t){e.exports='<div class="ts-pin-post-pane flex-fill">\n  <div>\n      <div class="pin-post-pane-title-container">\n          <button type="button" class="ts-sym app-icons-fill-hover pin-post-pane-back-button" ng-click="pinPostPaneCtrl.goToInfoPane()" aria-label="{{::$root.resources.strings.navigate_to_info_pane|translate}}" title="{{::$root.resources.strings.navigate_to_info_pane|translate}}" data-tid="pinPostPane-GoToInfoPane" track-summary="Navigate back to info pane">\n            <ng-include src="\'svg/icons-chevronmed-left.html\'"></ng-include>\n          </button>\n          <span class="pin-post-pane-title clickable" ng-click="pinPostPaneCtrl.goToInfoPane()">\n            {{::$root.resources.strings.pin_post_pane_title|translate}}\n          </span>\n        </div>\n  </div>\n  <div class="pinned-post-list-wrapper section-container" scrollbar-ignore-firefox-adjust="true" simple-scrollbar>\n    <div class="pinned-post-list">\n      <div class="section-title app-small-font app-font-weight-semibold" ng-if="pinPostPaneCtrl.unreadPosts && pinPostPaneCtrl.unreadPosts.length > 0">\n          {{::$root.resources.strings.pin_post_pane_new_pin_title|translate}}\n      </div>\n      <div class="pinned-post-list-unread-list">\n        <div vs-repeat="84" vs-excess="10" acc-role="listgrid-vertical" vs-repeat-track-by="$index" vs-options="{latch: true}" vs-scrolled-to-end-offset="1" vs-check-client-size="true" vs-scroll-parent=".pinned-post-list-wrapper">\n          <div ng-repeat="post in pinPostPaneCtrl.unreadPosts">\n            <pin-post-message-card view-model="post" ng-class="{ \'highlight-pin-post\' : pinPostPaneCtrl.latestMessageId === post.id }" acc-role="listgrid-item">\n            </pin-post-message-card>\n          </div>\n        </div>\n      </div>\n\n      <div class="section-title app-small-font app-font-weight-semibold" ng-if="pinPostPaneCtrl.readPosts && pinPostPaneCtrl.readPosts.length > 0">\n           {{::$root.resources.strings.pin_post_pane_seen_pin_title|translate}}\n      </div>\n      <div class="pinned-post-list-read-list">\n        <div vs-repeat="84" vs-excess="10" acc-role="listgrid-vertical" vs-repeat-track-by="$index" vs-options="{latch: true}" vs-scrolled-to-end-offset="1" vs-check-client-size="true" vs-scroll-parent=".pinned-post-list-wrapper">\n          <div ng-repeat="post in pinPostPaneCtrl.readPosts">\n            <pin-post-message-card view-model="post" ng-class="{ \'highlight-pin-post\' : pinPostPaneCtrl.latestMessageId === post.id }" acc-role="listgrid-item">\n            </pin-post-message-card>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>'},2240:function(e,t){e.exports='<div ng-if="!pinPostPaneCtrl.isLoading && (pinPostPaneCtrl.previewPosts && pinPostPaneCtrl.previewPosts.length > 0)" class="section-container">\n  <div class="section-content-body">\n    <div class="section-title">\n        <span class="pin-section-title app-small-font app-font-weight-semibold">{{::$root.resources.strings.pin_post_pane_title|translate}}</span>\n        <span class="section-link float-right" ng-if="pinPostPaneCtrl.previewPosts && pinPostPaneCtrl.previewPosts.length > 0" tabindex="0" ng-click="pinPostPaneCtrl.seeMore()">{{::$root.resources.strings.info_pane_view_all|translate}}</span>\n    </div>\n\n    <div class="pinned-post-list" ng-if="pinPostPaneCtrl.previewPosts && pinPostPaneCtrl.previewPosts.length > 0">\n      <div class="pinned-post-list-preview-list">\n        <div ng-repeat="post in pinPostPaneCtrl.previewPosts">\n          <pin-post-message-card view-model="post" ng-class="{ \'highlight-pin-post\' : pinPostPaneCtrl.latestMessageId === post.id }">\n          </pin-post-message-card>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>'},2241:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2242),s=n(2243),a=function(){function e(e,t,n,i,s,a,o,r,c,l,p,d){var h=this;this.$scope=e,this.$element=t,this.$timeout=n,this.constants=i,this.channelActivityService=s,this.infoPaneService=a,this.loggingService=o,this.accessibilityService=r,this.localizationService=c,this.resources=l,this.$translate=p,this.eventingService=d,this.isLoading=!1,this.defaultPageSize=30,this.defaultSystemMessageHeight=30,this.hasMoreToLoad=!0,this.throttleLoadMoreActivity=_.throttle(function(){h.getChannelActivity(!0)},500),this.numberOfPreviewChannelActivities=2,this.renderArea=teamspace.components.SystemMessageRenderArea.Channel,this.systemMessages=[],this.init()}return e.$inject=["$scope","$element","$timeout","constants","channelActivityService","infoPaneService","loggingService","accessibilityService","localizationService","resources","$translate","eventingService"],e.prototype.init=function(){var e=this;this.$scope.$watch("channelActivityCtrl.channel",function(){e.channel&&e.previousChannel&&e.previousChannel!==e.channel&&e.onChannelSwitch(),e.previousChannel=e.channel}),this.logger=this.loggingService.newLogger("ChannelActivityController"),this.scrollWrapper=this.$element.find(".channel-activity-list-wrapper"),this.focusOnBackToInfoPaneButton(),this.$scope.$watch("channelActivityCtrl.infoPaneService.isTopView",function(t,n){t&&!n&&e.infoPaneService.currentSection===services.InfoPaneSections.ACTIVITY&&e.focusOnSeeMoreUpdatesButton()}),this.infoPaneService.messageRenderedFullyPromise.then(function(){e.scrollWrapper&&(e.scrollWrapper.length>0?e.loadChannelActivityToFillScreen():e.getChannelActivity(),e.scrollWrapper.on("scroll",function(t){return e.onScroll(t)}),e.unbindItemResize=e.eventingService.$on(e.$scope,e.constants.events.virtualRepeat.itemResized,function(t,n){n&&e.updateHeight(n),e.$scope.$broadcast(e.constants.events.angularVsRepeat.vsRepeatTrigger)}))}),this.channelActivityService.safeSubscribe(this.$scope,function(t,n){n&&e.onAddChannelActivity(n.channelActivity)},this.constants.events.infoPane.channelActivity.added),this.$scope.$on("$destroy",function(){e.scrollWrapper=null,e.unbindItemResize&&e.unbindItemResize()})},e.prototype.focusOnBackToInfoPaneButton=function(){if(this.accessibilityService.isInKeyboardNavigationMode()){var e=this.$element.find('[data-tid="channel-activity-go-to-info-pane"]');e&&e.focus()}},e.prototype.focusOnSeeMoreUpdatesButton=function(){if(this.accessibilityService.isInKeyboardNavigationMode()){var e=this.$element.find('[data-tid="info-pane-see-more-updates-button"]');e&&e.focus()}},e.prototype.onChannelSwitch=function(){var e=this;this.systemMessages=[],this.hasMoreToLoad=!0,this.continuationToken=void 0,this.infoPaneService.messageRenderedFullyPromise.then(function(){e.getChannelActivity()})},Object.defineProperty(e.prototype,"isContentOverflow",{get:function(){return this.scrollWrapper&&this.scrollWrapper[0]&&this.scrollWrapper[0].scrollHeight>this.scrollWrapper[0].clientHeight},enumerable:!0,configurable:!0}),e.prototype.loadChannelActivityToFillScreen=function(){var e=this;this.hasMoreToLoad&&!this.isContentOverflow?this.getChannelActivity(!0).then(function(){e.$timeout(function(){e.loadChannelActivityToFillScreen()},0,!1)}):this.logger.warn("Don't load more channel activities\n       because hasMoreToLoad is "+this.hasMoreToLoad+" and\n       isContentOverflow is "+this.isContentOverflow)},e.prototype.getChannelActivity=function(e){var t=this;void 0===e&&(e=!1);var n=this.loggingService.newScenario(this.constants.scenarios.infoPane.channelActivity.getChannelActivity);if(this.channel&&!this.isLoading&&this.hasMoreToLoad){var i=null;if(e){var s=_.last(this.systemMessages);i=s&&_.first(s.messageViewModels)}this.isLoading=!0;return this.channelActivityService.getChannelActivity(this.channel.parentTeamId,this.channel.objectId,this.defaultPageSize,i,function(e){return e&&e.isRenderingKindSystem&&!_.isEmpty(e.hydratedProperties)},this.continuationToken).then(function(e){if(e){var i=e.messages;t.continuationToken=e.continuationToken;var s=_.map(i,function(e){return{messageViewModels:[e],formatDate:void 0,id:e.id,height:t.defaultSystemMessageHeight,expanded:!1}}),a=t.systemMessages.length;t.systemMessages=_.uniqBy(_.concat(t.systemMessages,s),function(e){return e.id}),t.systemMessages.length===a&&(t.hasMoreToLoad=!1),t.isLoading=!1,n.stop(),t.updateDateSeperator(),t.$timeout(function(){i.forEach(function(e){e&&e.id&&t.updateHeight(e.id)}),t.$scope.$broadcast(t.constants.events.angularVsRepeat.vsRepeatTrigger)},0,!1)}}).catch(function(e){t.isLoading=!1,t.hasMoreToLoad=!1,t.logger.warn("getChannelActivity failed, error: "+JSON.stringify(e)),n.fail({error:"getChannelActivity failed"})})}},e.prototype.updateHeight=function(e){var t=this.$element.find("#"+e),n=t&&t.height(),i=this.systemMessages.find(function(t){return t.id===e});i&&n&&(i.height=n),t=null},e.prototype.onAddChannelActivity=function(e){e&&e.getConversationIdFromConversationLink()===this.channel.objectId&&_.indexOf(this.channelActivityIds,e.id)<0&&this.systemMessages.unshift({messageViewModels:[e],formatDate:void 0,id:e.id,height:this.defaultSystemMessageHeight,expanded:!1})},Object.defineProperty(e.prototype,"channelActivityIds",{get:function(){return this.systemMessages?_.map(this.systemMessages,function(e){return e.id}):[]},enumerable:!0,configurable:!0}),e.prototype.updateDateSeperator=function(){var e=this,t=void 0,n=(new Date).setHours(0,0,0,0),i=new Date(Date.now()-this.constants.timeConversion.numMsInDay).setHours(0,0,0,0);_.forEach(this.systemMessages,function(s){s.formatDate=void 0;var a=_.first(s.messageViewModels);if(a&&a.originalarrivaltime){var o=new Date(a.originalarrivaltime).setHours(0,0,0,0);o!==t&&(s.formatDate=o===n?e.$translate.instant(e.resources.strings.activity_date_today):o===i?e.$translate.instant(e.resources.strings.activity_date_yesterday):e.localizationService.getDate(o,"longDate"),t=o)}})},e.prototype.onScroll=function(e){this.hasMoreToLoad&&e&&e.target&&e.target.scrollTop+e.target.clientHeight+30>e.target.scrollHeight&&this.hasMoreToLoad&&this.throttleLoadMoreActivity()},e.prototype.goToInfoPane=function(){this.continuationToken=void 0,this.infoPaneService.goToTopView(),this.sendBITelemetry(teamspace.components.PanelActionScenario.infoPaneGoBackToInfoPane,teamspace.components.PanelModuleName.ChannelActivitySection,"Click on go back to info pane button to navigate from channel activity pane to info pane")},e.prototype.seeAll=function(){this.infoPaneService.navigateTo(teamspace.services.InfoPaneSections.ACTIVITY),this.sendBITelemetry(teamspace.components.PanelActionScenario.infoPaneSeeMoreUpdates,teamspace.components.PanelModuleName.infoPaneChannelActivitySection,"Click on see more updates button to navigate to channel activity pane")},e.prototype.sendBITelemetry=function(e,t,n){var i={panelActionOutcome:teamspace.components.PanelActionOutcome.nav,panelActionScenario:e,panelActionScenarioType:teamspace.components.PanelActionScenarioType.nav,panelModuleName:t,panelModuleType:teamspace.components.PanelModuleType.infoPane,panelSummary:n};this.infoPaneService.sendBITelemetry(this.$scope,i)},e}();t.ChannelActivityController=a;var o=function(e){return{restrict:"E",scope:{},controllerAs:"channelActivityCtrl",bindToController:{channel:"<?"},controller:a,templateUrl:e}};angular.module("teamspace.channelActivityPane",["teamspace.channelActivityService","teamspace.infoPaneService"]).directive("channelActivityPane",function(){return o("components/right-pane/channel-activity-pane/channel-activity-pane.html")}).directive("infoPaneSectionActivity",function(){return o("components/right-pane/info-pane/sections/activity/info-pane-section-activity.html")}).run(["$templateCache",function(e){e.put("components/right-pane/channel-activity-pane/channel-activity-pane.html",i),e.put("components/right-pane/info-pane/sections/activity/info-pane-section-activity.html",s)}])},2242:function(e,t){e.exports='<div class="info-pane-detail-view-container flex-fill">\n  <div>\n    <div class="detail-view-title-container" acc-role="tab-handler-channel-activity-pane-back-button">\n      <button class="ts-sym channel-activity-back-button" ng-click="channelActivityCtrl.goToInfoPane()" aria-label="{{::$root.resources.strings.navigate_to_info_pane|translate}}" title="{{::$root.resources.strings.navigate_to_info_pane|translate}}" data-tid="channel-activity-go-to-info-pane" track-summary="Navigate back to info pane">\n        <span class="app-icons-fill-hover detail-view-back-button">\n          <ng-include src="\'svg/icons-chevronmed-left.html\'"></ng-include>\n        </span>\n        <span class="detail-view-pane-title">\n          {{::$root.resources.strings.info_pane_channel_activity_updates|translate}}\n        </span>\n      </button>\n\n    </div>\n  </div>\n  <div class="channel-activity-list-wrapper section-container" scrollbar-ignore-firefox-adjust="true" simple-scrollbar acc-role="tab-handler-channel-activity-list">\n    <div class="section-content-body channel-activity-list">\n      <div vs-repeat vs-size="height" vs-excess="20" vs-options="{hunked: true}" vs-check-client-size="true" vs-repeat-track-by="id" vs-scroll-parent=".channel-activity-list-wrapper">\n        <div ng-repeat="systemMessage in channelActivityCtrl.systemMessages track by systemMessage.id">\n          <div id="{{systemMessage.id}}" acc-role="channel-activity-system-message">\n            <div class="date-separator" ng-if="systemMessage.formatDate">\n              <div class="message-list-divider-text app-font-caption app-font-base-bold" role="heading" aria-level="3">\n                {{systemMessage.formatDate}}\n              </div>\n            </div>\n            <system-message render-area="::channelActivityCtrl.renderArea" thread="systemMessage">\n            </system-message>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>'},2243:function(e,t){e.exports='<div class="section-container" acc-role="tab-handler-info-pane-channel-activities" ng-if="channelActivityCtrl.systemMessages && channelActivityCtrl.systemMessages.length > 0">\n  <div acc-role="tab-handler-info-pane-see-more-updates-button">\n    <button class="ts-sym info-pane-section-title-container info-pane-section-activity-title-container" title="{{::$root.resources.strings.info_pane_more_updates_button_title|translate}}" aria-label="{{::$root.resources.strings.info_pane_more_updates_button_title|translate}}" ng-click="channelActivityCtrl.seeAll()" data-tid="info-pane-see-more-updates-button">\n      <span class="info-pane-section-title app-font-caption-semibold">\n        {{::$root.resources.strings.info_pane_channel_activity_updates|translate}}\n      </span>\n      <span class="app-icons-fill-hover right-arrow-button">\n        <ng-include src="\'svg/icons-chevronsm-right.html\'"></ng-include>\n      </span>\n    </button>\n  </div>\n  <div class="section-content-body section-channel-activity">\n    <div ng-repeat="systemMessage in channelActivityCtrl.systemMessages|limitTo:channelActivityCtrl.numberOfPreviewChannelActivities" acc-role="channel-activity-system-message">\n      <system-message render-area="::channelActivityCtrl.renderArea" thread="systemMessage">\n      </system-message>\n    </div>\n  </div>\n</div>'}},[2229]);